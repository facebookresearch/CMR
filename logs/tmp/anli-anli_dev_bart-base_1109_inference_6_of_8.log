11/09/2021 19:55:58 - INFO - __main__ - Config args: Namespace(append_another_bos=True, checkpoint='', dataset='nli', debug=False, dev_file='', do_lowercase=False, do_predict=True, do_train=False, max_input_length=512, max_output_length=10, model='facebook/bart-base', num_beams=3, output_dir='out/snli_bart-base_1109_upstream_model', predict_batch_size=64, predict_checkpoint='out/snli_bart-base_1109_upstream_model/best-model.pt', prefix='', quiet=False, seed=42, train_file='')
11/09/2021 19:55:58 - INFO - __main__ - dataset_size=6400, num_shards=8, local_shard_id=6
11/09/2021 19:55:59 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-vocab.json from cache at /private/home/yuchenlin/.cache/torch/transformers/1ae1f5b6e2b22b25ccc04c000bb79ca847aa226d0761536b011cf7e5868f0655.ef00af9e673c7160b4d41cfda1f48c5f4cba57d5142754525572a846a1ab1b9b
11/09/2021 19:55:59 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-merges.txt from cache at /private/home/yuchenlin/.cache/torch/transformers/f8f83199a6270d582d6245dc100e99c4155de81c9745c6248077018fe01abcfb.70bec105b4158ed9a1747fea67a43f5dee97855c64d62b6ec3742f4cfdb5feda
11/09/2021 19:55:59 - INFO - __main__ - Start tokenizing ... 800 instances
11/09/2021 19:55:59 - INFO - __main__ - Printing 3 examples
11/09/2021 19:55:59 - INFO - __main__ - Premise: Johns Creek is a city located in Fulton County in the U.S. state of Georgia. According to the 2010 U.S. Census, the population was 76,728. The city is an affluent northeastern suburb of Atlanta. In 2017 Johns Creek ranked third on the "USA TODAY" list of "50 best cities to live in." </s> Hypothesis: Johns Creek has a population of 92,000. | Options: entailment, neutral, contradiction 
11/09/2021 19:55:59 - INFO - __main__ - ['neutral']
11/09/2021 19:55:59 - INFO - __main__ - Premise: Club Deportivo Cajamadrid was a professional basketball and handball team in Spain. It was founded in 1979 and the basketball team played in Liga ACB from 1983 to 1986. The club was sponsored by Caja Madrid until 1991, when the bank decided to retire its support and continued as a different club called Juventud Alcalá. </s> Hypothesis: caja madrid started sponshorship of Club Deportivo Cajamadrid in 1979. | Options: entailment, neutral, contradiction 
11/09/2021 19:55:59 - INFO - __main__ - ['entailment']
11/09/2021 19:55:59 - INFO - __main__ - Premise: Dennis Princewell Stehr (born 15 May 1984), better known by his stage name Mr Probz, is a Dutch singer, musician and actor. In 2013, he released the song "Waves", which was remixed in 2014 by Robin Schulz, becoming an international hit. He has released one album and featured in the film Bolletjes Blues. </s> Hypothesis: By the time Mr Probz was 30 years old, he had an international hit. | Options: entailment, neutral, contradiction 
11/09/2021 19:55:59 - INFO - __main__ - ['entailment']
11/09/2021 19:55:59 - INFO - __main__ - Tokenizing Input ...
11/09/2021 19:56:00 - INFO - __main__ - Tokenizing Input ... Done!
11/09/2021 19:56:00 - INFO - __main__ - Tokenizing Output ...
11/09/2021 19:56:01 - INFO - __main__ - Tokenizing Output ... Done!
11/09/2021 19:56:01 - INFO - __main__ - Loaded 800 examples from dev data
11/09/2021 19:56:01 - INFO - __main__ - Loading checkpoint from out/snli_bart-base_1109_upstream_model/best-model.pt ....
11/09/2021 19:56:01 - INFO - transformers.configuration_utils - loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/facebook/bart-base/config.json from cache at /private/home/yuchenlin/.cache/torch/transformers/09f4fcaeaf785dd3b97b085d6e3510c7081f586ec8e75981683c6299c0f81d9d.e8d516ad807436d395effad8c2326786872659b7dd1210827ac67c761198a0eb
11/09/2021 19:56:01 - INFO - transformers.configuration_utils - Model config BartConfig {
  "activation_dropout": 0.1,
  "activation_function": "gelu",
  "add_bias_logits": false,
  "add_final_layer_norm": false,
  "architectures": [
    "BartModel",
    "BartForConditionalGeneration",
    "BartForSequenceClassification"
  ],
  "attention_dropout": 0.1,
  "bos_token_id": 0,
  "classif_dropout": 0.0,
  "d_model": 768,
  "decoder_attention_heads": 12,
  "decoder_ffn_dim": 3072,
  "decoder_layerdrop": 0.0,
  "decoder_layers": 6,
  "decoder_start_token_id": 2,
  "dropout": 0.1,
  "early_stopping": true,
  "encoder_attention_heads": 12,
  "encoder_ffn_dim": 3072,
  "encoder_layerdrop": 0.0,
  "encoder_layers": 6,
  "eos_token_id": 2,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1",
    "2": "LABEL_2"
  },
  "init_std": 0.02,
  "is_encoder_decoder": true,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1,
    "LABEL_2": 2
  },
  "max_position_embeddings": 1024,
  "model_type": "bart",
  "no_repeat_ngram_size": 3,
  "normalize_before": false,
  "normalize_embedding": true,
  "num_beams": 4,
  "num_hidden_layers": 6,
  "pad_token_id": 1,
  "scale_embedding": false,
  "static_position_embeddings": false,
  "task_specific_params": {
    "summarization": {
      "length_penalty": 1.0,
      "max_length": 128,
      "min_length": 12,
      "num_beams": 4
    },
    "summarization_cnn": {
      "length_penalty": 2.0,
      "max_length": 142,
      "min_length": 56,
      "num_beams": 4
    },
    "summarization_xsum": {
      "length_penalty": 1.0,
      "max_length": 62,
      "min_length": 11,
      "num_beams": 6
    }
  },
  "vocab_size": 50265
}

11/09/2021 19:56:02 - INFO - transformers.modeling_utils - loading weights file https://cdn.huggingface.co/facebook/bart-base/pytorch_model.bin from cache at /private/home/yuchenlin/.cache/torch/transformers/566c05fb6983817e8ad7a4fa51e3099fe9caa3b31730f964bc5198d71c677523.0a3d95c18c1e434448941bc25accea7b122882be6526fb67c8e8fb6d5ebc711c
11/09/2021 19:56:08 - INFO - __main__ - Loading checkpoint from out/snli_bart-base_1109_upstream_model/best-model.pt .... Done!
11/09/2021 19:56:14 - INFO - __main__ - Starting inference ...
Infernece:   0%|          | 0/13 [00:00<?, ?it/s]Infernece:   8%|▊         | 1/13 [00:01<00:15,  1.32s/it]Infernece:  15%|█▌        | 2/13 [00:02<00:14,  1.34s/it]Infernece:  23%|██▎       | 3/13 [00:03<00:13,  1.32s/it]Infernece:  31%|███       | 4/13 [00:05<00:11,  1.28s/it]Infernece:  38%|███▊      | 5/13 [00:06<00:10,  1.26s/it]Infernece:  46%|████▌     | 6/13 [00:07<00:08,  1.25s/it]Infernece:  54%|█████▍    | 7/13 [00:08<00:07,  1.25s/it]Infernece:  62%|██████▏   | 8/13 [00:09<00:06,  1.21s/it]Infernece:  69%|██████▉   | 9/13 [00:10<00:04,  1.09s/it]Infernece:  77%|███████▋  | 10/13 [00:11<00:03,  1.01s/it]Infernece:  85%|████████▍ | 11/13 [00:12<00:01,  1.05it/s]Infernece:  92%|█████████▏| 12/13 [00:13<00:00,  1.10it/s]Infernece: 100%|██████████| 13/13 [00:13<00:00,  1.25it/s]Infernece: 100%|██████████| 13/13 [00:13<00:00,  1.06s/it]
11/09/2021 19:56:28 - INFO - __main__ - Starting inference ... Done
