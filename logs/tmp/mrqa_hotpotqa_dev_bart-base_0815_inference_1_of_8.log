08/15/2021 15:48:16 - INFO - __main__ - Config args: Namespace(append_another_bos=True, checkpoint='', dataset='mrqa_naturalquestions', debug=False, dev_file='', do_lowercase=False, do_predict=True, do_train=False, max_input_length=888, max_output_length=50, model='facebook/bart-base', num_beams=4, output_dir='out/mrqa_naturalquestions_bart-base_0617v4', predict_batch_size=64, predict_checkpoint='out/mrqa_naturalquestions_bart-base_0617v4/best-model.pt', prefix='', quiet=False, seed=42, train_file='')
08/15/2021 15:48:16 - INFO - __main__ - dataset_size=5901, num_shards=8, local_shard_id=1
/private/home/yuchenlin/.conda/envs/bartqa/lib/python3.6/site-packages/numpy/core/_asarray.py:83: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  return array(a, dtype, copy=False, order=order)
08/15/2021 15:48:17 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-vocab.json from cache at /private/home/yuchenlin/.cache/torch/transformers/1ae1f5b6e2b22b25ccc04c000bb79ca847aa226d0761536b011cf7e5868f0655.ef00af9e673c7160b4d41cfda1f48c5f4cba57d5142754525572a846a1ab1b9b
08/15/2021 15:48:17 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-merges.txt from cache at /private/home/yuchenlin/.cache/torch/transformers/f8f83199a6270d582d6245dc100e99c4155de81c9745c6248077018fe01abcfb.70bec105b4158ed9a1747fea67a43f5dee97855c64d62b6ec3742f4cfdb5feda
08/15/2021 15:48:17 - INFO - __main__ - Start tokenizing ... 738 instances
08/15/2021 15:48:17 - INFO - __main__ - Printing 3 examples
08/15/2021 15:48:17 - INFO - __main__ - Context: Dennis Kux  Dennis H. Kux (born August 11, 1931 in London, England) is a diplomat and former United States Ambassador to Côte d'Ivoire (1986–89).  He is the author of "India and the United States: Estranged Democracies 1941-1991" (the book has an introduction by Daniel Moynihan) and "The United States and Pakistan, 1947-2000: Disenchanted Allies".  He is a member of the American Academy of Diplomacy and Council on Foreign Relations.  Kux served in the US embassy in Karachi in Pakistan from 1957 to 1959, followed by a tour in India.  He again served in Pakistan from 1969 to 1971.   Daniel Patrick Moynihan  Daniel Patrick "Pat" Moynihan (March 16, 1927 – March 26, 2003) was an American politician, sociologist, and diplomat.  A member of the Democratic Party, he represented New York in the United States Senate and served as an adviser to Republican President Richard Nixon.   Daniel Patrick Moynihan  Daniel Patrick "Pat" Moynihan (March 16, 1927 – March 26, 2003) was an American politician, sociologist, and diplomat.  A member of the Democratic Party, he represented New York in the United States Senate and served as an adviser to Republican President Richard Nixon. | Question: Who was elected more times, Daniel Patrick Moynihan or Dennis Kux?
08/15/2021 15:48:17 - INFO - __main__ - ['Daniel Patrick "Pat" Moynihan']
08/15/2021 15:48:17 - INFO - __main__ - Context: VAQ-138  Electronic Attack Squadron 138 (VAQ-138), also known as the "Yellow Jackets", is an expeditionary EA-18G Growler squadron of the United States Navy based at Naval Air Station Whidbey Island, Washington.  Their radio callsign is "RAMPAGE".   Boeing EA-18G Growler  The Boeing EA-18G Growler is an American carrier-based electronic warfare aircraft, a specialized version of the two-seat F/A-18F Super Hornet.  The EA-18G replaced the Northrop Grumman EA-6B Prowlers in service with the United States Navy.  The Growler's electronic warfare capability is primarily provided by Northrop Grumman.  The EA-18G began production in 2007 and entered operational service with the US Navy in late 2009.  Australia has also purchased twelve EA-18Gs, which entered service with the Royal Australian Air Force in 2017. | Question: Electronic Attack Squadron 138 is a type of which American carrier-based electronic warfare aircraft, a specialized version of the two-seat F/A-18F Super Hornet?
08/15/2021 15:48:17 - INFO - __main__ - ['Boeing EA-18G Growler']
08/15/2021 15:48:17 - INFO - __main__ - Context: Purcell, Kansas  Purcell is an unincorporated community in Doniphan County, Kansas, United States.  Purcell is located 5 mi east of Everest on highway K-20.   Doniphan County, Kansas  Doniphan County (county code DP) is a county located in the U.S. state of Kansas.  As of the 2010 census, the county population was 7,945.  Its county seat is Troy, and its most populous city is Wathena. | Question: where is the  a county where  Purcell can be found located ?
08/15/2021 15:48:17 - INFO - __main__ - ['the U.S. state of Kansas']
08/15/2021 15:48:17 - INFO - __main__ - Tokenizing Input ...
08/15/2021 15:48:20 - INFO - __main__ - Tokenizing Input ... Done!
08/15/2021 15:48:20 - INFO - __main__ - Tokenizing Output ...
08/15/2021 15:48:20 - INFO - __main__ - Tokenizing Output ... Done!
08/15/2021 15:48:20 - INFO - __main__ - Loaded 738 examples from dev data
08/15/2021 15:48:20 - INFO - __main__ - Loading checkpoint from out/mrqa_naturalquestions_bart-base_0617v4/best-model.pt ....
08/15/2021 15:48:21 - INFO - transformers.configuration_utils - loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/facebook/bart-base/config.json from cache at /private/home/yuchenlin/.cache/torch/transformers/09f4fcaeaf785dd3b97b085d6e3510c7081f586ec8e75981683c6299c0f81d9d.e8d516ad807436d395effad8c2326786872659b7dd1210827ac67c761198a0eb
08/15/2021 15:48:21 - INFO - transformers.configuration_utils - Model config BartConfig {
  "activation_dropout": 0.1,
  "activation_function": "gelu",
  "add_bias_logits": false,
  "add_final_layer_norm": false,
  "architectures": [
    "BartModel",
    "BartForConditionalGeneration",
    "BartForSequenceClassification"
  ],
  "attention_dropout": 0.1,
  "bos_token_id": 0,
  "classif_dropout": 0.0,
  "d_model": 768,
  "decoder_attention_heads": 12,
  "decoder_ffn_dim": 3072,
  "decoder_layerdrop": 0.0,
  "decoder_layers": 6,
  "decoder_start_token_id": 2,
  "dropout": 0.1,
  "early_stopping": true,
  "encoder_attention_heads": 12,
  "encoder_ffn_dim": 3072,
  "encoder_layerdrop": 0.0,
  "encoder_layers": 6,
  "eos_token_id": 2,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1",
    "2": "LABEL_2"
  },
  "init_std": 0.02,
  "is_encoder_decoder": true,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1,
    "LABEL_2": 2
  },
  "max_position_embeddings": 1024,
  "model_type": "bart",
  "no_repeat_ngram_size": 3,
  "normalize_before": false,
  "normalize_embedding": true,
  "num_beams": 4,
  "num_hidden_layers": 6,
  "pad_token_id": 1,
  "scale_embedding": false,
  "static_position_embeddings": false,
  "task_specific_params": {
    "summarization": {
      "length_penalty": 1.0,
      "max_length": 128,
      "min_length": 12,
      "num_beams": 4
    },
    "summarization_cnn": {
      "length_penalty": 2.0,
      "max_length": 142,
      "min_length": 56,
      "num_beams": 4
    },
    "summarization_xsum": {
      "length_penalty": 1.0,
      "max_length": 62,
      "min_length": 11,
      "num_beams": 6
    }
  },
  "vocab_size": 50265
}

08/15/2021 15:48:21 - INFO - transformers.modeling_utils - loading weights file https://cdn.huggingface.co/facebook/bart-base/pytorch_model.bin from cache at /private/home/yuchenlin/.cache/torch/transformers/566c05fb6983817e8ad7a4fa51e3099fe9caa3b31730f964bc5198d71c677523.0a3d95c18c1e434448941bc25accea7b122882be6526fb67c8e8fb6d5ebc711c
08/15/2021 15:48:27 - INFO - __main__ - Loading checkpoint from out/mrqa_naturalquestions_bart-base_0617v4/best-model.pt .... Done!
08/15/2021 15:48:33 - INFO - __main__ - Starting inference ...
Infernece:   0%|          | 0/12 [00:00<?, ?it/s]Infernece:   8%|▊         | 1/12 [00:06<01:13,  6.70s/it]Infernece:  17%|█▋        | 2/12 [00:14<01:09,  6.97s/it]Infernece:  25%|██▌       | 3/12 [00:21<01:02,  6.97s/it]Infernece:  33%|███▎      | 4/12 [00:25<00:50,  6.29s/it]Infernece:  42%|████▏     | 5/12 [00:31<00:42,  6.02s/it]Infernece:  50%|█████     | 6/12 [00:36<00:35,  5.89s/it]Infernece:  58%|█████▊    | 7/12 [00:42<00:28,  5.70s/it]Infernece:  67%|██████▋   | 8/12 [00:47<00:21,  5.46s/it]Infernece:  75%|███████▌  | 9/12 [00:51<00:15,  5.05s/it]Infernece:  83%|████████▎ | 10/12 [00:56<00:10,  5.05s/it]Infernece:  92%|█████████▏| 11/12 [00:59<00:04,  4.64s/it]Infernece: 100%|██████████| 12/12 [01:02<00:00,  4.12s/it]Infernece: 100%|██████████| 12/12 [01:02<00:00,  5.24s/it]
08/15/2021 15:49:36 - INFO - __main__ - Starting inference ... Done
