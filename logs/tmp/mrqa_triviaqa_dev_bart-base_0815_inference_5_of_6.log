08/16/2021 13:33:25 - INFO - __main__ - Config args: Namespace(append_another_bos=True, checkpoint='', dataset='mrqa_naturalquestions', debug=False, dev_file='', do_lowercase=False, do_predict=True, do_train=False, max_input_length=888, max_output_length=50, model='facebook/bart-base', num_beams=4, output_dir='out/mrqa_naturalquestions_bart-base_0617v4', predict_batch_size=64, predict_checkpoint='out/mrqa_naturalquestions_bart-base_0617v4/best-model.pt', prefix='', quiet=False, seed=42, train_file='')
08/16/2021 13:33:25 - INFO - __main__ - dataset_size=7784, num_shards=6, local_shard_id=5
/private/home/yuchenlin/.conda/envs/bartqa/lib/python3.6/site-packages/numpy/core/_asarray.py:83: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  return array(a, dtype, copy=False, order=order)
08/16/2021 13:33:26 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-vocab.json from cache at /private/home/yuchenlin/.cache/torch/transformers/1ae1f5b6e2b22b25ccc04c000bb79ca847aa226d0761536b011cf7e5868f0655.ef00af9e673c7160b4d41cfda1f48c5f4cba57d5142754525572a846a1ab1b9b
08/16/2021 13:33:26 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-merges.txt from cache at /private/home/yuchenlin/.cache/torch/transformers/f8f83199a6270d582d6245dc100e99c4155de81c9745c6248077018fe01abcfb.70bec105b4158ed9a1747fea67a43f5dee97855c64d62b6ec3742f4cfdb5feda
08/16/2021 13:33:26 - INFO - __main__ - Start tokenizing ... 1297 instances
08/16/2021 13:33:26 - INFO - __main__ - Printing 3 examples
08/16/2021 13:33:26 - INFO - __main__ - Context: King of Troy - Time Squad Wiki - WikiaKing of Troy | Time Squad Wiki | Fandom powered by Wikia  The King of Troy appears in "Never Look a Trojan in the Gift Horse," where he is celebrating his birthday during the Trojan War.  In the episode, he receives gifts from different countries, including golden cats from the Egyptians.  Sinon, a Greek warrior in charge of the Trojan Horse operation, wants to give the King a gift for his birthday instead of destroying Troy because Greeks are the best gift-givers. He gives the King several gifts that are all distributed in large, wooden animals, and the gifts could be found by pulling a lever on the animals. The first two wooden animals have candy and chocolate in them, but the King tells his servants to throw them away because he hates sweet foods. Finally, Sinon sends the King a wooden soldier full of wild Spanish horses, which destroy Troy and run over the King, thus winning the war for the Greeks.  Contents  Edit  The King of Troy is dressed in a purple cloak and he wears a crown over an apparently balding spot on his head. His hair is white, and he has a long white beard. When seen standing by his main servant, he is shown to be considerably shorter.  Personality  Edit  While receiving his gifts, the King is seen as rather bored, especially when he predictably recieves a golden cat from the Egyptians. He is a bit excited when he sees the Trojan Horse because it is his largest present, perhaps showing his more extravagant tastes. One interesting fact to note is that the King isn't suspicious of the Greeks giving him presents while they are at war, though this is probably because he knows the Greeks enjoy showing off. After receiving two disappointing gifts from the Greeks, the King is annoyed by the arrival of the third gift. He panics when he sees the horses destroying Troy.  In History  Edit  In history, the King of Troy during the Trojan War was Priam,  who was known as a courageous leader. This is obviously not the case in the episode, where the King panics and is run over by terrified citizens and horses.  Gallery  Siege of Troy | Article about Siege of Troy by The Free ...Siege of Troy | Article about Siege of Troy by The Free Dictionary  Siege of Troy | Article about Siege of Troy by The Free Dictionary  http://encyclopedia2.thefreedictionary.com/Siege+of+Troy  Also found in: Dictionary , Thesaurus , Wikipedia .  Trojan War,  in Greek mythology, war between the Greeks and the people of Troy Troy,  ancient city made famous by Homer's account of the Trojan War. It is also called Ilion or, in Latin, Ilium. Its site is almost universally accepted as the mound now named Hissarlik, in Asian Turkey, c.4 mi (6.4 km) from the mouth of the Dardanelles.  ..... Click the link for more information. . The strife began after the Trojan prince Paris Paris  or Alexander,  in Greek mythology, son of Priam and Hecuba and brother of Hector. Because it was prophesied that he would cause the destruction of Troy, Paris was abandoned on Mt. Ida, but there he was raised by shepherds and loved by the nymph Oenone.  ..... Click the link for more information.  abducted Helen Helen,  in Greek mythology, the most beautiful of women; daughter of Leda and Zeus, and sister of Castor and Pollux and Clytemnestra. While still a young girl Helen was abducted to Attica by Theseus and Polydeuces, but Castor and Pollux rescued her.  ..... Click the link for more information. , wife of Menelaus Menelaus  , in Greek mythology, king of Sparta, son of Atreus. He was the husband of Helen, father of Hermione, and younger brother of Agamemnon. When Paris, prince of Troy, abducted Helen, Menelaus asked the other Greek kings to join him in an expedition against Troy, beginning  ..... Click the link for more information.  of Sparta. When Menelaus demanded her return, the Trojans refused. Menelaus then persuaded his brother Agamemnon Agamemnon | Question: Who was the King of Troy during the famous siege?
08/16/2021 13:33:26 - INFO - __main__ - ['priam']
08/16/2021 13:33:26 - INFO - __main__ - Context: The Third Man | film directed by Welles [1949 ...The Third Man | film directed by Welles [1949] | Britannica.com  film directed by Welles [1949]  THIS IS A DIRECTORY PAGE. Britannica does not currently have an article on this topic.  Orson Welles in The Third Man (1949), directed by Welles.  © 1949 London Film Productions  Learn about this topic in these articles:     in Sir Carol Reed  ...Graham Greene and producer Alexander Korda—on his next film, The Fallen Idol (1948). The following year, the trio turned out what is arguably Reed’s greatest film, The Third Man (1949), a Cold War thriller starring Joseph Cotten and Orson Welles. The film won first prize at the Cannes Film Festival, and Reed was nominated for best director at the Academy...  The Third Man (1949) - The Criterion CollectionThe Third Man (1949) - The Criterion Collection  The Criterion Collection     Spine #64  Pulp novelist Holly Martins travels to shadowy, postwar Vienna, only to find himself investigating the mysterious death of an old friend, black-market opportunist Harry Lime—and thus begins this legendary tale of love, deception, and murder. Thanks to brilliant performances by Joseph Cotten, Alida Valli, and Orson Welles; Anton Karas’s evocative zither score; Graham Greene’s razor-sharp dialogue; and Robert Krasker’s dramatic use of light and shadow, The Third Man, directed by the inimitable Carol Reed, only grows in stature as the years pass.  Cast  New, restored high-definition digital transfer, with uncompressed mono soundtrack on the Blu-ray edition  Video introduction by writer-director Peter Bogdanovich  Two audio commentaries: one by filmmaker Steven Soderbergh and screenwriter Tony Gilroy, and one by film scholar Dana Polan  Shadowing “The Third Man” (2005), a ninety-minute feature documentary on the making of the film  Abridged recording of Graham Greene’s treatment, read by actor Richard Clarke  “Graham Greene: The Hunted Man,” an hour-long, 1968 episode of the BBC’s Omnibus series, featuring a rare interview with the novelist  Who Was the Third Man? (2000), a thirty-minute Austrian documentary featuring interviews with cast and crew  The Third Man on the radio: the 1951 “A Ticket to Tangiers” episode of The Lives of Harry Lime series, written and performed by Orson Welles; and the 1951 Lux Radio Theatre adaptation of The Third Man  Illustrated production history with rare behind-the-scenes photos, original UK press book, and U.S. trailer  Actor Joseph Cotten’s alternate opening voice-over narration for the U.S. version  Archival footage of postwar Vienna  A look at the untranslated foreign dialogue in the film  Optional English subtitles for the deaf and hard of hearing  PLUS: A booklet featuring new essays by Luc Sante (DVD and Blu-ray), Charles Drazin (DVD only) and Philip Kerr (DVD only)  New cover by Lucien S. Y. Yang  Current Posts  Did You See This?  March 25, 2016  Director Ben Wheatley discusses his favorite films, which include Godard’s Weekend. After watching it, he says, “I almost felt like I’d had the stack of cards in my head rearranged and . . . Read more »  Video  The Third Man: The One and Only . . .  By Luc Sante December 16, 2008  The Third Man (1949) is one of that handful of motion pictures (Rashomon, Casablanca, The Searchers) that have become archetypes—not merely a movie that would go on to influence myriad other . . . Read more »  Film Essays  The Third Man: Seeing Greene  By Philip Kerr May 21, 2007  In The Third Man, Holly Martins, an alcoholic American writer of “cheap novelettes” (Oklahoma Kid and The Lone Rider of Santa Fe, among others) and a man who was “born to be murdered,” arrives . . . Read more »  Film Essays  Behind | Question: Who directed the 1949 film, 'The Third Man'?
08/16/2021 13:33:26 - INFO - __main__ - ['carol reed']
08/16/2021 13:33:26 - INFO - __main__ - Context: Take a Bow (Rihanna song)"Take a Bow" is a song recorded by Barbadian singer Rihanna for Good Girl Gone Bad: Reloaded (2008), the re-release of her third studio album Good Girl Gone Bad (2007). The song was written and produced by Tor Erik Hermansen, Mikkel Eriksen, and Shaffer Smith under their stage names StarGate and Ne-Yo. "Take a Bow" was released as the first single from the re-release and the fifth single overall from the two releases. It is an R&B song that contains elements of dance-pop. Critical reception of "Take a Bow" was mixed, with some critics praising the song's lyrics and powerful balladry impact, while others criticized the lack of originality with regard to StarGate's production.  In the US, the song peaked at number one on the Billboard Hot 100 chart and became Rihanna's third song to do so. "Take a Bow" also peaked at number one on the US Hot R&B/Hip-Hop Songs chart and US Pop Songs chart, and has been certified quadruple platinum by the Recording Industry Association of America. The song reached number one in Canada, Denmark, Ireland, Slovakia and the United Kingdom, and attained top five positions in Australia, New Zealand and Norway. The song's accompanying music video was directed by Anthony Mandler and presents Rihanna as the female protagonist who leaves her boyfriend because of his infidelity. "Take a Bow" has been performed on "AOL Music Sessions" and was included in the set lists of the Good Girl Gone Bad Tour (2008–09), Last Girl on Earth (2010–11), Loud Tour (2011) and Diamonds World Tour (2013).  Background and composition  "Take a Bow" was written and produced by StarGate and Ne-Yo. The song premiered on February 14, 2008, on the KIIS-FM radio show On Air with Ryan Seacrest.  "Take a Bow" was released as the fifth overall single from Good Girl Gone Bad, but the first from the re-release of the album, entitled Good Girl Gone Bad: Reloaded.  "Take a Bow" was made available to purchase in media outlets, via Def Jam Recordings' website, on the same day as its radio premiere in the United States  later being made available to download via iTunes on May 6, 2008.  The song is written in the key of E major and is set in simple time with a metronome of 82 beats per minute.  Rihanna's vocal range in the song spans from the low note of E3 to the high note of C♯5. Musically, the song draws influence from the musical genre of R&B and also incorporates elements of dance-pop, whilst lyrically, "Take a Bow" tells of how the female protagonist expresses disinterest in rekindling her relationship with an dishonorable and unfaithful ex-boyfriend.  Critical reception  "Take a Bow" received mixed reviews from music critics. Upon the song's release as an official single, Nick Levine of Digital Spy commented its choice for the promotion of Good Girl Gone Bad: Reloaded, writing that the singer could have chosen "Breakin' Dishes" which served as a promotional single for Good Girl Gone Bad and charted at number four on the US Hot Dance Club Songs chart in February 2008 —but had opted for "Take a Bow" due to it being new and more likely to find a receptive audience.  Levine continued in his review to write that although the ballad succeeds in its mission of telling of a failed relationship, he noted that the song was not at the same level as the singer's previous single, "Don't Stop the Music" (2007). Levine cited that his reason for this was that "'Take a Bow' does what it sets out to do very well, but it's an underwhelming follow-up to the dancefloor rush of 'Don't Stop The Music". Levine also commented on the song with regard to the other new songs included on the re-release, "Disturbia" and "If I Never See Your Face Again" (a collaboration | Question: Which singer had a 2008 number one hit with the song 'Take A Bow'?
08/16/2021 13:33:26 - INFO - __main__ - ['rihanna', 'riri']
08/16/2021 13:33:26 - INFO - __main__ - Tokenizing Input ...
08/16/2021 13:33:35 - INFO - __main__ - Tokenizing Input ... Done!
08/16/2021 13:33:35 - INFO - __main__ - Tokenizing Output ...
08/16/2021 13:33:36 - INFO - __main__ - Tokenizing Output ... Done!
08/16/2021 13:33:36 - INFO - __main__ - Loaded 1297 examples from dev data
08/16/2021 13:33:36 - INFO - __main__ - Loading checkpoint from out/mrqa_naturalquestions_bart-base_0617v4/best-model.pt ....
08/16/2021 13:33:40 - INFO - transformers.configuration_utils - loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/facebook/bart-base/config.json from cache at /private/home/yuchenlin/.cache/torch/transformers/09f4fcaeaf785dd3b97b085d6e3510c7081f586ec8e75981683c6299c0f81d9d.e8d516ad807436d395effad8c2326786872659b7dd1210827ac67c761198a0eb
08/16/2021 13:33:40 - INFO - transformers.configuration_utils - Model config BartConfig {
  "activation_dropout": 0.1,
  "activation_function": "gelu",
  "add_bias_logits": false,
  "add_final_layer_norm": false,
  "architectures": [
    "BartModel",
    "BartForConditionalGeneration",
    "BartForSequenceClassification"
  ],
  "attention_dropout": 0.1,
  "bos_token_id": 0,
  "classif_dropout": 0.0,
  "d_model": 768,
  "decoder_attention_heads": 12,
  "decoder_ffn_dim": 3072,
  "decoder_layerdrop": 0.0,
  "decoder_layers": 6,
  "decoder_start_token_id": 2,
  "dropout": 0.1,
  "early_stopping": true,
  "encoder_attention_heads": 12,
  "encoder_ffn_dim": 3072,
  "encoder_layerdrop": 0.0,
  "encoder_layers": 6,
  "eos_token_id": 2,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1",
    "2": "LABEL_2"
  },
  "init_std": 0.02,
  "is_encoder_decoder": true,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1,
    "LABEL_2": 2
  },
  "max_position_embeddings": 1024,
  "model_type": "bart",
  "no_repeat_ngram_size": 3,
  "normalize_before": false,
  "normalize_embedding": true,
  "num_beams": 4,
  "num_hidden_layers": 6,
  "pad_token_id": 1,
  "scale_embedding": false,
  "static_position_embeddings": false,
  "task_specific_params": {
    "summarization": {
      "length_penalty": 1.0,
      "max_length": 128,
      "min_length": 12,
      "num_beams": 4
    },
    "summarization_cnn": {
      "length_penalty": 2.0,
      "max_length": 142,
      "min_length": 56,
      "num_beams": 4
    },
    "summarization_xsum": {
      "length_penalty": 1.0,
      "max_length": 62,
      "min_length": 11,
      "num_beams": 6
    }
  },
  "vocab_size": 50265
}

08/16/2021 13:33:40 - INFO - transformers.modeling_utils - loading weights file https://cdn.huggingface.co/facebook/bart-base/pytorch_model.bin from cache at /private/home/yuchenlin/.cache/torch/transformers/566c05fb6983817e8ad7a4fa51e3099fe9caa3b31730f964bc5198d71c677523.0a3d95c18c1e434448941bc25accea7b122882be6526fb67c8e8fb6d5ebc711c
08/16/2021 13:33:45 - INFO - __main__ - Loading checkpoint from out/mrqa_naturalquestions_bart-base_0617v4/best-model.pt .... Done!
08/16/2021 13:33:50 - INFO - __main__ - Starting inference ...
Infernece:   0%|          | 0/21 [00:00<?, ?it/s]Infernece:   5%|▍         | 1/21 [00:07<02:25,  7.26s/it]Infernece:  10%|▉         | 2/21 [00:14<02:15,  7.16s/it]Infernece:  14%|█▍        | 3/21 [00:20<02:06,  7.05s/it]Infernece:  19%|█▉        | 4/21 [00:27<01:59,  7.02s/it]Infernece:  24%|██▍       | 5/21 [00:35<01:52,  7.06s/it]Infernece:  29%|██▊       | 6/21 [00:41<01:44,  6.97s/it]Infernece:  33%|███▎      | 7/21 [00:48<01:36,  6.91s/it]Infernece:  38%|███▊      | 8/21 [00:55<01:29,  6.87s/it]Infernece:  43%|████▎     | 9/21 [01:02<01:23,  6.93s/it]Infernece:  48%|████▊     | 10/21 [01:09<01:17,  7.01s/it]Infernece:  52%|█████▏    | 11/21 [01:16<01:09,  6.96s/it]Infernece:  57%|█████▋    | 12/21 [01:23<01:02,  6.93s/it]Infernece:  62%|██████▏   | 13/21 [01:30<00:55,  6.88s/it]Infernece:  67%|██████▋   | 14/21 [01:36<00:47,  6.84s/it]Infernece:  71%|███████▏  | 15/21 [01:43<00:40,  6.74s/it]Infernece:  76%|███████▌  | 16/21 [01:50<00:33,  6.71s/it]Infernece:  81%|████████  | 17/21 [01:57<00:27,  6.80s/it]Infernece:  86%|████████▌ | 18/21 [02:03<00:20,  6.83s/it]Infernece:  90%|█████████ | 19/21 [02:10<00:13,  6.80s/it]Infernece:  95%|█████████▌| 20/21 [02:17<00:06,  6.80s/it]Infernece: 100%|██████████| 21/21 [02:19<00:00,  5.41s/it]Infernece: 100%|██████████| 21/21 [02:19<00:00,  6.65s/it]
08/16/2021 13:36:10 - INFO - __main__ - Starting inference ... Done
