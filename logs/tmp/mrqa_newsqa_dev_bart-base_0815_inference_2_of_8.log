10/29/2021 11:40:14 - INFO - __main__ - Config args: Namespace(append_another_bos=True, checkpoint='', dataset='mrqa', debug=False, dev_file='', do_lowercase=False, do_predict=True, do_train=False, max_input_length=888, max_output_length=50, model='facebook/bart-base', num_beams=3, output_dir='out/mrqa_naturalquestions_bart-base_1028_upstream_model/', predict_batch_size=64, predict_checkpoint='out/mrqa_naturalquestions_bart-base_1028_upstream_model//best-model.pt', prefix='', quiet=False, seed=42, train_file='')
10/29/2021 11:40:14 - INFO - __main__ - dataset_size=4212, num_shards=8, local_shard_id=2
10/29/2021 11:40:15 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-vocab.json from cache at /private/home/yuchenlin/.cache/torch/transformers/1ae1f5b6e2b22b25ccc04c000bb79ca847aa226d0761536b011cf7e5868f0655.ef00af9e673c7160b4d41cfda1f48c5f4cba57d5142754525572a846a1ab1b9b
10/29/2021 11:40:15 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-merges.txt from cache at /private/home/yuchenlin/.cache/torch/transformers/f8f83199a6270d582d6245dc100e99c4155de81c9745c6248077018fe01abcfb.70bec105b4158ed9a1747fea67a43f5dee97855c64d62b6ec3742f4cfdb5feda
10/29/2021 11:40:15 - INFO - __main__ - Start tokenizing ... 527 instances
10/29/2021 11:40:15 - INFO - __main__ - Printing 3 examples
10/29/2021 11:40:15 - INFO - __main__ - Question: Who cared about Somalia? </s> Context: Editor's note: William Jelani Cobb is Associate Professor of History at Spelman College, and author of the forthcoming "Change Has Come: Barack Obama and the Meaning of Progress." He blogs at http://americanexception.com/William Jelani Cobb says Somalia's piracy problem was fueled by environmental and political events.(CNN) -- The drama of an American ship captain held hostage by Somali pirates led last Sunday's talk shows.Just hours before Maersk Alabama Capt. Richard Phillips was rescued, the piracy incident was discussed as one of the "tests" of President Obama that Joe Biden warned about during the campaign.Others wondered whether wars in Iraq and Afghanistan have stretched our military resources too thin to respond effectively to these kinds of provocations. Many expressed outrage at the brand of naval gangsterism that by some estimates generated as much as $80 million in 2008.Clearly this escalating pattern of pirate attacks may soon constitute an international crisis. But what this situation actually reveals is how little we've learned in the nearly eight years since George W. Bush declared war on terror.Somalia is like Afghanistan in that we had a great deal of interest in the place during the Cold War and more or less forgot about it afterward. The United States supported the government of Said Barre during the 1980s primarily for the same reason we began funneling aid to the Afghan rebels: anticommunism.Barre was a regional counterpoint to the Marxist regime next door in Ethiopia and strategically important enough for his human rights abuses to be tolerated. And like Afghanistan, Somalia quickly fell into disarray after the Cold War ended and the United States cut off support.During the early post-Cold War era, the United States developed a more narrowly defined set of interests and it was common to hear American foreign policy circles express disdain for "nation-building" projects. But two decades later we continue to deal with the consequences of our abrupt exit from both countries.Our fleeting humanitarian concern with Somalia ended with the downing of two Blackhawk helicopters in 1993. But that incident actually served as a kind of foreshadowing and highlighted yet another link to Afghanistan: The forces that attacked American troops in Mogadishu were reportedly linked to al Qaeda.The 9/11 attacks and Afghanistan's role in sheltering al Qaeda should have given us reason to re-examine other regions where similar blowback might take place. In short, we might well have looked at what was going on in Afghanistan after September 11, 2001, and seen trouble on the horizon elsewhere.The Somali situation was further complicated by a series of economic and ecological problems that have struck the region in the past decade. In the wake of the government collapse, the Somali coast became a target of illegal commercial fishing. This is a problem across East and Southern Africa but rampant in Somalia. According to one report, some 700 vessels were illegally operating in the region and fishing the local stock to near depletion.As recently as 2006 Somali fishermen complained to the U.N. that illegal fishing was driving them to the brink of economic collapse. To add to the burden, the coast also became a favorite locale for nuclear waste dumping.In 2005, U.N. officials confirmed that barrels containing illegally dumped nuclear waste had cracked open during the tsunami that year and begun washing ashore. The situation was widely reported by international news outlets with virtually no consequences.No matter what we think of their current methods, it's impossible to solve the piracy problem without addressing the illegal fishing issue. Somalia lacks a functioning navy -- or government. Similarly, we were not talking about the over-fishing and nuclear waste issues -- to the extent we do talk about them now -- before the Somalis began to respond in kind.These environmental violations will undoubtedly cost lives and the West has more or less ignored Somali pleas. Our intense and highly selective outrage began when the Somalis started targeting commercial vehicles.Faced with this response it's hard to avoid the conclusion that the Western consumer products, carried by these ships are more valuable than Somali lives.Given the recent history of unstable states like Afghanistan and Iraq, piracy is actually one of the milder
10/29/2021 11:40:15 - INFO - __main__ - ['William Jelani Cobb']
10/29/2021 11:40:15 - INFO - __main__ - Question: What did Cobb say? </s> Context: Editor's note: William Jelani Cobb is Associate Professor of History at Spelman College, and author of the forthcoming "Change Has Come: Barack Obama and the Meaning of Progress." He blogs at http://americanexception.com/William Jelani Cobb says Somalia's piracy problem was fueled by environmental and political events.(CNN) -- The drama of an American ship captain held hostage by Somali pirates led last Sunday's talk shows.Just hours before Maersk Alabama Capt. Richard Phillips was rescued, the piracy incident was discussed as one of the "tests" of President Obama that Joe Biden warned about during the campaign.Others wondered whether wars in Iraq and Afghanistan have stretched our military resources too thin to respond effectively to these kinds of provocations. Many expressed outrage at the brand of naval gangsterism that by some estimates generated as much as $80 million in 2008.Clearly this escalating pattern of pirate attacks may soon constitute an international crisis. But what this situation actually reveals is how little we've learned in the nearly eight years since George W. Bush declared war on terror.Somalia is like Afghanistan in that we had a great deal of interest in the place during the Cold War and more or less forgot about it afterward. The United States supported the government of Said Barre during the 1980s primarily for the same reason we began funneling aid to the Afghan rebels: anticommunism.Barre was a regional counterpoint to the Marxist regime next door in Ethiopia and strategically important enough for his human rights abuses to be tolerated. And like Afghanistan, Somalia quickly fell into disarray after the Cold War ended and the United States cut off support.During the early post-Cold War era, the United States developed a more narrowly defined set of interests and it was common to hear American foreign policy circles express disdain for "nation-building" projects. But two decades later we continue to deal with the consequences of our abrupt exit from both countries.Our fleeting humanitarian concern with Somalia ended with the downing of two Blackhawk helicopters in 1993. But that incident actually served as a kind of foreshadowing and highlighted yet another link to Afghanistan: The forces that attacked American troops in Mogadishu were reportedly linked to al Qaeda.The 9/11 attacks and Afghanistan's role in sheltering al Qaeda should have given us reason to re-examine other regions where similar blowback might take place. In short, we might well have looked at what was going on in Afghanistan after September 11, 2001, and seen trouble on the horizon elsewhere.The Somali situation was further complicated by a series of economic and ecological problems that have struck the region in the past decade. In the wake of the government collapse, the Somali coast became a target of illegal commercial fishing. This is a problem across East and Southern Africa but rampant in Somalia. According to one report, some 700 vessels were illegally operating in the region and fishing the local stock to near depletion.As recently as 2006 Somali fishermen complained to the U.N. that illegal fishing was driving them to the brink of economic collapse. To add to the burden, the coast also became a favorite locale for nuclear waste dumping.In 2005, U.N. officials confirmed that barrels containing illegally dumped nuclear waste had cracked open during the tsunami that year and begun washing ashore. The situation was widely reported by international news outlets with virtually no consequences.No matter what we think of their current methods, it's impossible to solve the piracy problem without addressing the illegal fishing issue. Somalia lacks a functioning navy -- or government. Similarly, we were not talking about the over-fishing and nuclear waste issues -- to the extent we do talk about them now -- before the Somalis began to respond in kind.These environmental violations will undoubtedly cost lives and the West has more or less ignored Somali pleas. Our intense and highly selective outrage began when the Somalis started targeting commercial vehicles.Faced with this response it's hard to avoid the conclusion that the Western consumer products, carried by these ships are more valuable than Somali lives.Given the recent history of unstable states like Afghanistan and Iraq, piracy is actually one of the milder
10/29/2021 11:40:15 - INFO - __main__ - ["Somalia's piracy problem was fueled by environmental and political events."]
10/29/2021 11:40:15 - INFO - __main__ - Question: What is said to have caused piracy? </s> Context: Editor's note: William Jelani Cobb is Associate Professor of History at Spelman College, and author of the forthcoming "Change Has Come: Barack Obama and the Meaning of Progress." He blogs at http://americanexception.com/William Jelani Cobb says Somalia's piracy problem was fueled by environmental and political events.(CNN) -- The drama of an American ship captain held hostage by Somali pirates led last Sunday's talk shows.Just hours before Maersk Alabama Capt. Richard Phillips was rescued, the piracy incident was discussed as one of the "tests" of President Obama that Joe Biden warned about during the campaign.Others wondered whether wars in Iraq and Afghanistan have stretched our military resources too thin to respond effectively to these kinds of provocations. Many expressed outrage at the brand of naval gangsterism that by some estimates generated as much as $80 million in 2008.Clearly this escalating pattern of pirate attacks may soon constitute an international crisis. But what this situation actually reveals is how little we've learned in the nearly eight years since George W. Bush declared war on terror.Somalia is like Afghanistan in that we had a great deal of interest in the place during the Cold War and more or less forgot about it afterward. The United States supported the government of Said Barre during the 1980s primarily for the same reason we began funneling aid to the Afghan rebels: anticommunism.Barre was a regional counterpoint to the Marxist regime next door in Ethiopia and strategically important enough for his human rights abuses to be tolerated. And like Afghanistan, Somalia quickly fell into disarray after the Cold War ended and the United States cut off support.During the early post-Cold War era, the United States developed a more narrowly defined set of interests and it was common to hear American foreign policy circles express disdain for "nation-building" projects. But two decades later we continue to deal with the consequences of our abrupt exit from both countries.Our fleeting humanitarian concern with Somalia ended with the downing of two Blackhawk helicopters in 1993. But that incident actually served as a kind of foreshadowing and highlighted yet another link to Afghanistan: The forces that attacked American troops in Mogadishu were reportedly linked to al Qaeda.The 9/11 attacks and Afghanistan's role in sheltering al Qaeda should have given us reason to re-examine other regions where similar blowback might take place. In short, we might well have looked at what was going on in Afghanistan after September 11, 2001, and seen trouble on the horizon elsewhere.The Somali situation was further complicated by a series of economic and ecological problems that have struck the region in the past decade. In the wake of the government collapse, the Somali coast became a target of illegal commercial fishing. This is a problem across East and Southern Africa but rampant in Somalia. According to one report, some 700 vessels were illegally operating in the region and fishing the local stock to near depletion.As recently as 2006 Somali fishermen complained to the U.N. that illegal fishing was driving them to the brink of economic collapse. To add to the burden, the coast also became a favorite locale for nuclear waste dumping.In 2005, U.N. officials confirmed that barrels containing illegally dumped nuclear waste had cracked open during the tsunami that year and begun washing ashore. The situation was widely reported by international news outlets with virtually no consequences.No matter what we think of their current methods, it's impossible to solve the piracy problem without addressing the illegal fishing issue. Somalia lacks a functioning navy -- or government. Similarly, we were not talking about the over-fishing and nuclear waste issues -- to the extent we do talk about them now -- before the Somalis began to respond in kind.These environmental violations will undoubtedly cost lives and the West has more or less ignored Somali pleas. Our intense and highly selective outrage began when the Somalis started targeting commercial vehicles.Faced with this response it's hard to avoid the conclusion that the Western consumer products, carried by these ships are more valuable than Somali lives.Given the recent history of unstable states like Afghanistan and Iraq, piracy is actually one of the milder
10/29/2021 11:40:15 - INFO - __main__ - ['environmental and political events.']
10/29/2021 11:40:15 - INFO - __main__ - Tokenizing Input ...
10/29/2021 11:40:17 - INFO - __main__ - Tokenizing Input ... Done!
10/29/2021 11:40:17 - INFO - __main__ - Tokenizing Output ...
10/29/2021 11:40:17 - INFO - __main__ - Tokenizing Output ... Done!
10/29/2021 11:40:17 - INFO - __main__ - Loaded 527 examples from dev data
10/29/2021 11:40:17 - INFO - __main__ - Loading checkpoint from out/mrqa_naturalquestions_bart-base_1028_upstream_model//best-model.pt ....
10/29/2021 11:40:17 - INFO - transformers.configuration_utils - loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/facebook/bart-base/config.json from cache at /private/home/yuchenlin/.cache/torch/transformers/09f4fcaeaf785dd3b97b085d6e3510c7081f586ec8e75981683c6299c0f81d9d.e8d516ad807436d395effad8c2326786872659b7dd1210827ac67c761198a0eb
10/29/2021 11:40:17 - INFO - transformers.configuration_utils - Model config BartConfig {
  "activation_dropout": 0.1,
  "activation_function": "gelu",
  "add_bias_logits": false,
  "add_final_layer_norm": false,
  "architectures": [
    "BartModel",
    "BartForConditionalGeneration",
    "BartForSequenceClassification"
  ],
  "attention_dropout": 0.1,
  "bos_token_id": 0,
  "classif_dropout": 0.0,
  "d_model": 768,
  "decoder_attention_heads": 12,
  "decoder_ffn_dim": 3072,
  "decoder_layerdrop": 0.0,
  "decoder_layers": 6,
  "decoder_start_token_id": 2,
  "dropout": 0.1,
  "early_stopping": true,
  "encoder_attention_heads": 12,
  "encoder_ffn_dim": 3072,
  "encoder_layerdrop": 0.0,
  "encoder_layers": 6,
  "eos_token_id": 2,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1",
    "2": "LABEL_2"
  },
  "init_std": 0.02,
  "is_encoder_decoder": true,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1,
    "LABEL_2": 2
  },
  "max_position_embeddings": 1024,
  "model_type": "bart",
  "no_repeat_ngram_size": 3,
  "normalize_before": false,
  "normalize_embedding": true,
  "num_beams": 4,
  "num_hidden_layers": 6,
  "pad_token_id": 1,
  "scale_embedding": false,
  "static_position_embeddings": false,
  "task_specific_params": {
    "summarization": {
      "length_penalty": 1.0,
      "max_length": 128,
      "min_length": 12,
      "num_beams": 4
    },
    "summarization_cnn": {
      "length_penalty": 2.0,
      "max_length": 142,
      "min_length": 56,
      "num_beams": 4
    },
    "summarization_xsum": {
      "length_penalty": 1.0,
      "max_length": 62,
      "min_length": 11,
      "num_beams": 6
    }
  },
  "vocab_size": 50265
}

10/29/2021 11:40:17 - INFO - transformers.modeling_utils - loading weights file https://cdn.huggingface.co/facebook/bart-base/pytorch_model.bin from cache at /private/home/yuchenlin/.cache/torch/transformers/566c05fb6983817e8ad7a4fa51e3099fe9caa3b31730f964bc5198d71c677523.0a3d95c18c1e434448941bc25accea7b122882be6526fb67c8e8fb6d5ebc711c
10/29/2021 11:40:22 - INFO - __main__ - Loading checkpoint from out/mrqa_naturalquestions_bart-base_1028_upstream_model//best-model.pt .... Done!
10/29/2021 11:40:29 - INFO - __main__ - Starting inference ...
Infernece:   0%|          | 0/9 [00:00<?, ?it/s]Infernece:  11%|█         | 1/9 [00:05<00:43,  5.46s/it]Infernece:  22%|██▏       | 2/9 [00:10<00:36,  5.23s/it]Infernece:  33%|███▎      | 3/9 [00:13<00:28,  4.76s/it]Infernece:  44%|████▍     | 4/9 [00:17<00:22,  4.52s/it]Infernece:  56%|█████▌    | 5/9 [00:21<00:17,  4.41s/it]Infernece:  67%|██████▋   | 6/9 [00:25<00:12,  4.29s/it]Infernece:  78%|███████▊  | 7/9 [00:30<00:08,  4.25s/it]Infernece:  89%|████████▉ | 8/9 [00:33<00:04,  4.14s/it]Infernece: 100%|██████████| 9/9 [00:35<00:00,  3.33s/it]Infernece: 100%|██████████| 9/9 [00:35<00:00,  3.94s/it]
10/29/2021 11:41:04 - INFO - __main__ - Starting inference ... Done
