10/29/2021 17:15:04 - INFO - __main__ - Config args: Namespace(append_another_bos=True, checkpoint='', dataset='mrqa', debug=False, dev_file='', do_lowercase=False, do_predict=True, do_train=False, max_input_length=888, max_output_length=50, model='facebook/bart-base', num_beams=3, output_dir='out/mrqa_squad_bart-base_1029_upstream_model/', predict_batch_size=64, predict_checkpoint='out/mrqa_squad_bart-base_1029_upstream_model//best-model.pt', prefix='', quiet=False, seed=42, train_file='')
10/29/2021 17:15:05 - INFO - __main__ - dataset_size=86420, num_shards=8, local_shard_id=3
10/29/2021 17:15:05 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-vocab.json from cache at /private/home/yuchenlin/.cache/torch/transformers/1ae1f5b6e2b22b25ccc04c000bb79ca847aa226d0761536b011cf7e5868f0655.ef00af9e673c7160b4d41cfda1f48c5f4cba57d5142754525572a846a1ab1b9b
10/29/2021 17:15:05 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-merges.txt from cache at /private/home/yuchenlin/.cache/torch/transformers/f8f83199a6270d582d6245dc100e99c4155de81c9745c6248077018fe01abcfb.70bec105b4158ed9a1747fea67a43f5dee97855c64d62b6ec3742f4cfdb5feda
10/29/2021 17:15:05 - INFO - __main__ - Start tokenizing ... 10803 instances
10/29/2021 17:15:05 - INFO - __main__ - Printing 3 examples
10/29/2021 17:15:05 - INFO - __main__ - Question: How many divisions of the U.S. Army were in Europe? </s> Context: The end of World War II set the stage for the East–West confrontation known as the Cold War. With the outbreak of the Korean War, concerns over the defense of Western Europe rose. Two corps, V and VII, were reactivated under Seventh United States Army in 1950 and American strength in Europe rose from one division to four. Hundreds of thousands of U.S. troops remained stationed in West Germany, with others in Belgium, the Netherlands and the United Kingdom, until the 1990s in anticipation of a possible Soviet attack.
10/29/2021 17:15:05 - INFO - __main__ - ['four']
10/29/2021 17:15:05 - INFO - __main__ - Question: Who adopted the Total Force Policy? </s> Context: The Total Force Policy was adopted by Chief of Staff of the Army General Creighton Abrams in the aftermath of the Vietnam War and involves treating the three components of the army – the Regular Army, the Army National Guard and the Army Reserve as a single force. Believing that no U.S. president should be able to take the United States (and more specifically the U.S. Army) to war without the support of the American people, General Abrams intertwined the structure of the three components of the army in such a way as to make extended operations impossible, without the involvement of both the Army National Guard and the Army Reserve.
10/29/2021 17:15:05 - INFO - __main__ - ['General Creighton Abrams']
10/29/2021 17:15:05 - INFO - __main__ - Question: What war was responsible for the creation of the Total Force Policy? </s> Context: The Total Force Policy was adopted by Chief of Staff of the Army General Creighton Abrams in the aftermath of the Vietnam War and involves treating the three components of the army – the Regular Army, the Army National Guard and the Army Reserve as a single force. Believing that no U.S. president should be able to take the United States (and more specifically the U.S. Army) to war without the support of the American people, General Abrams intertwined the structure of the three components of the army in such a way as to make extended operations impossible, without the involvement of both the Army National Guard and the Army Reserve.
10/29/2021 17:15:05 - INFO - __main__ - ['Vietnam War']
10/29/2021 17:15:05 - INFO - __main__ - Tokenizing Input ...
10/29/2021 17:15:15 - INFO - __main__ - Tokenizing Input ... Done!
10/29/2021 17:15:15 - INFO - __main__ - Tokenizing Output ...
10/29/2021 17:15:16 - INFO - __main__ - Tokenizing Output ... Done!
10/29/2021 17:15:16 - INFO - __main__ - Loaded 10803 examples from dev data
10/29/2021 17:15:16 - INFO - __main__ - Loading checkpoint from out/mrqa_squad_bart-base_1029_upstream_model//best-model.pt ....
10/29/2021 17:15:17 - INFO - transformers.configuration_utils - loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/facebook/bart-base/config.json from cache at /private/home/yuchenlin/.cache/torch/transformers/09f4fcaeaf785dd3b97b085d6e3510c7081f586ec8e75981683c6299c0f81d9d.e8d516ad807436d395effad8c2326786872659b7dd1210827ac67c761198a0eb
10/29/2021 17:15:17 - INFO - transformers.configuration_utils - Model config BartConfig {
  "activation_dropout": 0.1,
  "activation_function": "gelu",
  "add_bias_logits": false,
  "add_final_layer_norm": false,
  "architectures": [
    "BartModel",
    "BartForConditionalGeneration",
    "BartForSequenceClassification"
  ],
  "attention_dropout": 0.1,
  "bos_token_id": 0,
  "classif_dropout": 0.0,
  "d_model": 768,
  "decoder_attention_heads": 12,
  "decoder_ffn_dim": 3072,
  "decoder_layerdrop": 0.0,
  "decoder_layers": 6,
  "decoder_start_token_id": 2,
  "dropout": 0.1,
  "early_stopping": true,
  "encoder_attention_heads": 12,
  "encoder_ffn_dim": 3072,
  "encoder_layerdrop": 0.0,
  "encoder_layers": 6,
  "eos_token_id": 2,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1",
    "2": "LABEL_2"
  },
  "init_std": 0.02,
  "is_encoder_decoder": true,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1,
    "LABEL_2": 2
  },
  "max_position_embeddings": 1024,
  "model_type": "bart",
  "no_repeat_ngram_size": 3,
  "normalize_before": false,
  "normalize_embedding": true,
  "num_beams": 4,
  "num_hidden_layers": 6,
  "pad_token_id": 1,
  "scale_embedding": false,
  "static_position_embeddings": false,
  "task_specific_params": {
    "summarization": {
      "length_penalty": 1.0,
      "max_length": 128,
      "min_length": 12,
      "num_beams": 4
    },
    "summarization_cnn": {
      "length_penalty": 2.0,
      "max_length": 142,
      "min_length": 56,
      "num_beams": 4
    },
    "summarization_xsum": {
      "length_penalty": 1.0,
      "max_length": 62,
      "min_length": 11,
      "num_beams": 6
    }
  },
  "vocab_size": 50265
}

10/29/2021 17:15:17 - INFO - transformers.modeling_utils - loading weights file https://cdn.huggingface.co/facebook/bart-base/pytorch_model.bin from cache at /private/home/yuchenlin/.cache/torch/transformers/566c05fb6983817e8ad7a4fa51e3099fe9caa3b31730f964bc5198d71c677523.0a3d95c18c1e434448941bc25accea7b122882be6526fb67c8e8fb6d5ebc711c
10/29/2021 17:15:21 - INFO - __main__ - Loading checkpoint from out/mrqa_squad_bart-base_1029_upstream_model//best-model.pt .... Done!
10/29/2021 17:15:24 - INFO - __main__ - Starting inference ...
Infernece:   0%|          | 0/169 [00:00<?, ?it/s]Infernece:   1%|          | 1/169 [00:01<05:19,  1.90s/it]Infernece:   1%|          | 2/169 [00:04<05:36,  2.02s/it]Infernece:   2%|▏         | 3/169 [00:06<05:41,  2.06s/it]Infernece:   2%|▏         | 4/169 [00:08<06:06,  2.22s/it]Infernece:   3%|▎         | 5/169 [00:10<05:48,  2.13s/it]Infernece:   4%|▎         | 6/169 [00:12<05:36,  2.06s/it]Infernece:   4%|▍         | 7/169 [00:14<05:36,  2.08s/it]Infernece:   5%|▍         | 8/169 [00:16<05:23,  2.01s/it]Infernece:   5%|▌         | 9/169 [00:18<05:20,  2.00s/it]Infernece:   6%|▌         | 10/169 [00:20<05:08,  1.94s/it]Infernece:   7%|▋         | 11/169 [00:22<05:30,  2.09s/it]Infernece:   7%|▋         | 12/169 [00:24<05:24,  2.07s/it]Infernece:   8%|▊         | 13/169 [00:27<05:58,  2.30s/it]Infernece:   8%|▊         | 14/169 [00:29<05:48,  2.25s/it]Infernece:   9%|▉         | 15/169 [00:31<05:29,  2.14s/it]Infernece:   9%|▉         | 16/169 [00:34<05:42,  2.24s/it]Infernece:  10%|█         | 17/169 [00:36<05:38,  2.23s/it]Infernece:  11%|█         | 18/169 [00:38<05:41,  2.26s/it]Infernece:  11%|█         | 19/169 [00:41<05:58,  2.39s/it]Infernece:  12%|█▏        | 20/169 [00:43<05:56,  2.39s/it]Infernece:  12%|█▏        | 21/169 [00:45<05:34,  2.26s/it]Infernece:  13%|█▎        | 22/169 [00:48<05:46,  2.35s/it]Infernece:  14%|█▎        | 23/169 [00:50<05:50,  2.40s/it]Infernece:  14%|█▍        | 24/169 [00:53<05:46,  2.39s/it]Infernece:  15%|█▍        | 25/169 [00:56<06:31,  2.72s/it]Infernece:  15%|█▌        | 26/169 [00:59<06:38,  2.79s/it]Infernece:  16%|█▌        | 27/169 [01:03<07:00,  2.96s/it]Infernece:  17%|█▋        | 28/169 [01:06<07:21,  3.13s/it]Infernece:  17%|█▋        | 29/169 [01:09<07:10,  3.08s/it]Infernece:  18%|█▊        | 30/169 [01:12<06:48,  2.94s/it]Infernece:  18%|█▊        | 31/169 [01:13<05:49,  2.53s/it]Infernece:  19%|█▉        | 32/169 [01:15<05:20,  2.34s/it]Infernece:  20%|█▉        | 33/169 [01:17<04:48,  2.12s/it]Infernece:  20%|██        | 34/169 [01:19<04:59,  2.22s/it]Infernece:  21%|██        | 35/169 [01:21<04:28,  2.00s/it]Infernece:  21%|██▏       | 36/169 [01:23<04:23,  1.98s/it]Infernece:  22%|██▏       | 37/169 [01:24<04:07,  1.88s/it]Infernece:  22%|██▏       | 38/169 [01:27<04:26,  2.04s/it]Infernece:  23%|██▎       | 39/169 [01:29<04:33,  2.10s/it]Infernece:  24%|██▎       | 40/169 [01:32<04:52,  2.27s/it]Infernece:  24%|██▍       | 41/169 [01:34<04:53,  2.29s/it]Infernece:  25%|██▍       | 42/169 [01:36<04:33,  2.15s/it]Infernece:  25%|██▌       | 43/169 [01:38<04:39,  2.22s/it]Infernece:  26%|██▌       | 44/169 [01:41<04:45,  2.28s/it]Infernece:  27%|██▋       | 45/169 [01:44<05:11,  2.51s/it]Infernece:  27%|██▋       | 46/169 [01:45<04:41,  2.29s/it]Infernece:  28%|██▊       | 47/169 [01:47<04:15,  2.10s/it]Infernece:  28%|██▊       | 48/169 [01:50<04:32,  2.25s/it]Infernece:  29%|██▉       | 49/169 [01:52<04:47,  2.39s/it]Infernece:  30%|██▉       | 50/169 [01:56<05:22,  2.71s/it]Infernece:  30%|███       | 51/169 [01:59<05:30,  2.80s/it]Infernece:  31%|███       | 52/169 [02:01<05:14,  2.68s/it]Infernece:  31%|███▏      | 53/169 [02:04<05:20,  2.77s/it]Infernece:  32%|███▏      | 54/169 [02:07<05:23,  2.82s/it]Infernece:  33%|███▎      | 55/169 [02:10<05:33,  2.92s/it]Infernece:  33%|███▎      | 56/169 [02:13<05:10,  2.75s/it]Infernece:  34%|███▎      | 57/169 [02:14<04:37,  2.48s/it]Infernece:  34%|███▍      | 58/169 [02:17<04:35,  2.48s/it]Infernece:  35%|███▍      | 59/169 [02:19<04:26,  2.43s/it]Infernece:  36%|███▌      | 60/169 [02:21<04:14,  2.33s/it]Infernece:  36%|███▌      | 61/169 [02:23<04:03,  2.25s/it]Infernece:  37%|███▋      | 62/169 [02:26<04:08,  2.32s/it]Infernece:  37%|███▋      | 63/169 [02:28<03:54,  2.21s/it]Infernece:  38%|███▊      | 64/169 [02:30<03:39,  2.09s/it]Infernece:  38%|███▊      | 65/169 [02:32<03:58,  2.29s/it]Infernece:  39%|███▉      | 66/169 [02:35<03:49,  2.22s/it]Infernece:  40%|███▉      | 67/169 [02:37<04:02,  2.38s/it]Infernece:  40%|████      | 68/169 [02:39<03:49,  2.27s/it]Infernece:  41%|████      | 69/169 [02:42<03:49,  2.29s/it]Infernece:  41%|████▏     | 70/169 [02:43<03:32,  2.15s/it]Infernece:  42%|████▏     | 71/169 [02:45<03:26,  2.11s/it]Infernece:  43%|████▎     | 72/169 [02:47<03:20,  2.07s/it]Infernece:  43%|████▎     | 73/169 [02:50<03:21,  2.10s/it]Infernece:  44%|████▍     | 74/169 [02:52<03:31,  2.23s/it]Infernece:  44%|████▍     | 75/169 [02:55<03:45,  2.40s/it]Infernece:  45%|████▍     | 76/169 [02:57<03:41,  2.38s/it]Infernece:  46%|████▌     | 77/169 [02:59<03:22,  2.20s/it]Infernece:  46%|████▌     | 78/169 [03:01<03:23,  2.24s/it]Infernece:  47%|████▋     | 79/169 [03:04<03:35,  2.39s/it]Infernece:  47%|████▋     | 80/169 [03:07<03:56,  2.66s/it]Infernece:  48%|████▊     | 81/169 [03:10<03:38,  2.49s/it]Infernece:  49%|████▊     | 82/169 [03:12<03:24,  2.35s/it]Infernece:  49%|████▉     | 83/169 [03:14<03:28,  2.43s/it]Infernece:  50%|████▉     | 84/169 [03:16<03:15,  2.30s/it]Infernece:  50%|█████     | 85/169 [03:18<03:03,  2.19s/it]Infernece:  51%|█████     | 86/169 [03:20<02:55,  2.11s/it]Infernece:  51%|█████▏    | 87/169 [03:23<03:13,  2.36s/it]Infernece:  52%|█████▏    | 88/169 [03:25<03:08,  2.32s/it]Infernece:  53%|█████▎    | 89/169 [03:27<03:00,  2.26s/it]Infernece:  53%|█████▎    | 90/169 [03:30<02:58,  2.26s/it]Infernece:  54%|█████▍    | 91/169 [03:31<02:44,  2.11s/it]Infernece:  54%|█████▍    | 92/169 [03:33<02:37,  2.04s/it]Infernece:  55%|█████▌    | 93/169 [03:35<02:29,  1.97s/it]Infernece:  56%|█████▌    | 94/169 [03:37<02:32,  2.04s/it]Infernece:  56%|█████▌    | 95/169 [03:39<02:31,  2.05s/it]Infernece:  57%|█████▋    | 96/169 [03:43<02:57,  2.43s/it]Infernece:  57%|█████▋    | 97/169 [03:45<02:43,  2.27s/it]Infernece:  58%|█████▊    | 98/169 [03:47<02:46,  2.35s/it]Infernece:  59%|█████▊    | 99/169 [03:50<03:07,  2.68s/it]Infernece:  59%|█████▉    | 100/169 [03:54<03:20,  2.90s/it]Infernece:  60%|█████▉    | 101/169 [03:56<03:09,  2.79s/it]Infernece:  60%|██████    | 102/169 [03:58<02:46,  2.48s/it]Infernece:  61%|██████    | 103/169 [04:01<02:49,  2.57s/it]Infernece:  62%|██████▏   | 104/169 [04:04<02:46,  2.56s/it]Infernece:  62%|██████▏   | 105/169 [04:06<02:48,  2.64s/it]Infernece:  63%|██████▎   | 106/169 [04:09<02:52,  2.74s/it]Infernece:  63%|██████▎   | 107/169 [04:11<02:37,  2.54s/it]Infernece:  64%|██████▍   | 108/169 [04:14<02:44,  2.69s/it]Infernece:  64%|██████▍   | 109/169 [04:18<02:53,  2.89s/it]Infernece:  65%|██████▌   | 110/169 [04:21<03:03,  3.10s/it]Infernece:  66%|██████▌   | 111/169 [04:25<03:02,  3.14s/it]Infernece:  66%|██████▋   | 112/169 [04:27<02:47,  2.94s/it]Infernece:  67%|██████▋   | 113/169 [04:30<02:49,  3.03s/it]Infernece:  67%|██████▋   | 114/169 [04:33<02:44,  2.98s/it]Infernece:  68%|██████▊   | 115/169 [04:36<02:31,  2.80s/it]Infernece:  69%|██████▊   | 116/169 [04:37<02:13,  2.52s/it]Infernece:  69%|██████▉   | 117/169 [04:40<02:15,  2.61s/it]Infernece:  70%|██████▉   | 118/169 [04:42<02:04,  2.44s/it]Infernece:  70%|███████   | 119/169 [04:45<02:00,  2.40s/it]Infernece:  71%|███████   | 120/169 [04:47<01:53,  2.32s/it]Infernece:  72%|███████▏  | 121/169 [04:49<01:43,  2.17s/it]Infernece:  72%|███████▏  | 122/169 [04:51<01:43,  2.19s/it]Infernece:  73%|███████▎  | 123/169 [04:54<01:52,  2.44s/it]Infernece:  73%|███████▎  | 124/169 [04:56<01:52,  2.49s/it]Infernece:  74%|███████▍  | 125/169 [04:59<01:47,  2.44s/it]Infernece:  75%|███████▍  | 126/169 [05:01<01:40,  2.34s/it]Infernece:  75%|███████▌  | 127/169 [05:03<01:32,  2.20s/it]Infernece:  76%|███████▌  | 128/169 [05:04<01:24,  2.06s/it]Infernece:  76%|███████▋  | 129/169 [05:07<01:29,  2.24s/it]Infernece:  77%|███████▋  | 130/169 [05:10<01:33,  2.41s/it]Infernece:  78%|███████▊  | 131/169 [05:12<01:27,  2.29s/it]Infernece:  78%|███████▊  | 132/169 [05:14<01:27,  2.36s/it]Infernece:  79%|███████▊  | 133/169 [05:16<01:20,  2.23s/it]Infernece:  79%|███████▉  | 134/169 [05:19<01:17,  2.21s/it]Infernece:  80%|███████▉  | 135/169 [05:21<01:15,  2.23s/it]Infernece:  80%|████████  | 136/169 [05:23<01:11,  2.16s/it]Infernece:  81%|████████  | 137/169 [05:25<01:12,  2.28s/it]Infernece:  82%|████████▏ | 138/169 [05:28<01:10,  2.28s/it]Infernece:  82%|████████▏ | 139/169 [05:30<01:11,  2.37s/it]Infernece:  83%|████████▎ | 140/169 [05:33<01:08,  2.36s/it]Infernece:  83%|████████▎ | 141/169 [05:35<01:03,  2.27s/it]Infernece:  84%|████████▍ | 142/169 [05:37<00:58,  2.16s/it]Infernece:  85%|████████▍ | 143/169 [05:39<00:56,  2.18s/it]Infernece:  85%|████████▌ | 144/169 [05:41<00:53,  2.15s/it]Infernece:  86%|████████▌ | 145/169 [05:44<00:57,  2.41s/it]Infernece:  86%|████████▋ | 146/169 [05:46<00:53,  2.33s/it]Infernece:  87%|████████▋ | 147/169 [05:49<00:54,  2.47s/it]Infernece:  88%|████████▊ | 148/169 [05:52<00:54,  2.59s/it]Infernece:  88%|████████▊ | 149/169 [05:54<00:51,  2.57s/it]Infernece:  89%|████████▉ | 150/169 [05:56<00:46,  2.45s/it]Infernece:  89%|████████▉ | 151/169 [05:59<00:45,  2.51s/it]Infernece:  90%|████████▉ | 152/169 [06:02<00:43,  2.59s/it]Infernece:  91%|█████████ | 153/169 [06:04<00:39,  2.49s/it]Infernece:  91%|█████████ | 154/169 [06:07<00:41,  2.77s/it]Infernece:  92%|█████████▏| 155/169 [06:10<00:38,  2.76s/it]Infernece:  92%|█████████▏| 156/169 [06:14<00:38,  2.93s/it]Infernece:  93%|█████████▎| 157/169 [06:16<00:34,  2.84s/it]Infernece:  93%|█████████▎| 158/169 [06:19<00:30,  2.75s/it]Infernece:  94%|█████████▍| 159/169 [06:21<00:27,  2.76s/it]Infernece:  95%|█████████▍| 160/169 [06:24<00:24,  2.71s/it]Infernece:  95%|█████████▌| 161/169 [06:26<00:20,  2.57s/it]Infernece:  96%|█████████▌| 162/169 [06:29<00:17,  2.46s/it]Infernece:  96%|█████████▋| 163/169 [06:31<00:13,  2.33s/it]Infernece:  97%|█████████▋| 164/169 [06:33<00:11,  2.31s/it]Infernece:  98%|█████████▊| 165/169 [06:35<00:08,  2.13s/it]Infernece:  98%|█████████▊| 166/169 [06:36<00:06,  2.04s/it]Infernece:  99%|█████████▉| 167/169 [06:39<00:04,  2.21s/it]Infernece:  99%|█████████▉| 168/169 [06:42<00:02,  2.48s/it]Infernece: 100%|██████████| 169/169 [06:43<00:00,  2.14s/it]Infernece: 100%|██████████| 169/169 [06:43<00:00,  2.39s/it]
10/29/2021 17:22:08 - INFO - __main__ - Starting inference ... Done
