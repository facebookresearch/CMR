10/29/2021 17:15:04 - INFO - __main__ - Config args: Namespace(append_another_bos=True, checkpoint='', dataset='mrqa', debug=False, dev_file='', do_lowercase=False, do_predict=True, do_train=False, max_input_length=888, max_output_length=50, model='facebook/bart-base', num_beams=3, output_dir='out/mrqa_squad_bart-base_1029_upstream_model/', predict_batch_size=64, predict_checkpoint='out/mrqa_squad_bart-base_1029_upstream_model//best-model.pt', prefix='', quiet=False, seed=42, train_file='')
10/29/2021 17:15:04 - INFO - __main__ - dataset_size=86420, num_shards=8, local_shard_id=1
10/29/2021 17:15:05 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-vocab.json from cache at /private/home/yuchenlin/.cache/torch/transformers/1ae1f5b6e2b22b25ccc04c000bb79ca847aa226d0761536b011cf7e5868f0655.ef00af9e673c7160b4d41cfda1f48c5f4cba57d5142754525572a846a1ab1b9b
10/29/2021 17:15:05 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-merges.txt from cache at /private/home/yuchenlin/.cache/torch/transformers/f8f83199a6270d582d6245dc100e99c4155de81c9745c6248077018fe01abcfb.70bec105b4158ed9a1747fea67a43f5dee97855c64d62b6ec3742f4cfdb5feda
10/29/2021 17:15:05 - INFO - __main__ - Start tokenizing ... 10803 instances
10/29/2021 17:15:05 - INFO - __main__ - Printing 3 examples
10/29/2021 17:15:05 - INFO - __main__ - Question: What is the acronym for British Broadcasting Corporation? </s> Context: BBC Television is a service of the British Broadcasting Corporation. The corporation, which has operated in the United Kingdom under the terms of a Royal charter since 1927, has produced television programmes from its own since 1932, although the start of its regular service of television broadcasts is dated to 2 November 1936.
10/29/2021 17:15:05 - INFO - __main__ - ['BBC']
10/29/2021 17:15:05 - INFO - __main__ - Question: Under what auspices does the BBC exist? </s> Context: BBC Television is a service of the British Broadcasting Corporation. The corporation, which has operated in the United Kingdom under the terms of a Royal charter since 1927, has produced television programmes from its own since 1932, although the start of its regular service of television broadcasts is dated to 2 November 1936.
10/29/2021 17:15:05 - INFO - __main__ - ['Royal charter']
10/29/2021 17:15:05 - INFO - __main__ - Question: When did the BBC start creating its own programming? </s> Context: BBC Television is a service of the British Broadcasting Corporation. The corporation, which has operated in the United Kingdom under the terms of a Royal charter since 1927, has produced television programmes from its own since 1932, although the start of its regular service of television broadcasts is dated to 2 November 1936.
10/29/2021 17:15:05 - INFO - __main__ - ['1932']
10/29/2021 17:15:05 - INFO - __main__ - Tokenizing Input ...
10/29/2021 17:15:13 - INFO - __main__ - Tokenizing Input ... Done!
10/29/2021 17:15:13 - INFO - __main__ - Tokenizing Output ...
10/29/2021 17:15:14 - INFO - __main__ - Tokenizing Output ... Done!
10/29/2021 17:15:14 - INFO - __main__ - Loaded 10803 examples from dev data
10/29/2021 17:15:14 - INFO - __main__ - Loading checkpoint from out/mrqa_squad_bart-base_1029_upstream_model//best-model.pt ....
10/29/2021 17:15:15 - INFO - transformers.configuration_utils - loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/facebook/bart-base/config.json from cache at /private/home/yuchenlin/.cache/torch/transformers/09f4fcaeaf785dd3b97b085d6e3510c7081f586ec8e75981683c6299c0f81d9d.e8d516ad807436d395effad8c2326786872659b7dd1210827ac67c761198a0eb
10/29/2021 17:15:15 - INFO - transformers.configuration_utils - Model config BartConfig {
  "activation_dropout": 0.1,
  "activation_function": "gelu",
  "add_bias_logits": false,
  "add_final_layer_norm": false,
  "architectures": [
    "BartModel",
    "BartForConditionalGeneration",
    "BartForSequenceClassification"
  ],
  "attention_dropout": 0.1,
  "bos_token_id": 0,
  "classif_dropout": 0.0,
  "d_model": 768,
  "decoder_attention_heads": 12,
  "decoder_ffn_dim": 3072,
  "decoder_layerdrop": 0.0,
  "decoder_layers": 6,
  "decoder_start_token_id": 2,
  "dropout": 0.1,
  "early_stopping": true,
  "encoder_attention_heads": 12,
  "encoder_ffn_dim": 3072,
  "encoder_layerdrop": 0.0,
  "encoder_layers": 6,
  "eos_token_id": 2,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1",
    "2": "LABEL_2"
  },
  "init_std": 0.02,
  "is_encoder_decoder": true,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1,
    "LABEL_2": 2
  },
  "max_position_embeddings": 1024,
  "model_type": "bart",
  "no_repeat_ngram_size": 3,
  "normalize_before": false,
  "normalize_embedding": true,
  "num_beams": 4,
  "num_hidden_layers": 6,
  "pad_token_id": 1,
  "scale_embedding": false,
  "static_position_embeddings": false,
  "task_specific_params": {
    "summarization": {
      "length_penalty": 1.0,
      "max_length": 128,
      "min_length": 12,
      "num_beams": 4
    },
    "summarization_cnn": {
      "length_penalty": 2.0,
      "max_length": 142,
      "min_length": 56,
      "num_beams": 4
    },
    "summarization_xsum": {
      "length_penalty": 1.0,
      "max_length": 62,
      "min_length": 11,
      "num_beams": 6
    }
  },
  "vocab_size": 50265
}

10/29/2021 17:15:15 - INFO - transformers.modeling_utils - loading weights file https://cdn.huggingface.co/facebook/bart-base/pytorch_model.bin from cache at /private/home/yuchenlin/.cache/torch/transformers/566c05fb6983817e8ad7a4fa51e3099fe9caa3b31730f964bc5198d71c677523.0a3d95c18c1e434448941bc25accea7b122882be6526fb67c8e8fb6d5ebc711c
10/29/2021 17:15:18 - INFO - __main__ - Loading checkpoint from out/mrqa_squad_bart-base_1029_upstream_model//best-model.pt .... Done!
10/29/2021 17:15:23 - INFO - __main__ - Starting inference ...
Infernece:   0%|          | 0/169 [00:00<?, ?it/s]Infernece:   1%|          | 1/169 [00:02<07:18,  2.61s/it]Infernece:   1%|          | 2/169 [00:05<07:05,  2.55s/it]Infernece:   2%|▏         | 3/169 [00:07<06:39,  2.41s/it]Infernece:   2%|▏         | 4/169 [00:09<06:21,  2.31s/it]Infernece:   3%|▎         | 5/169 [00:10<05:40,  2.08s/it]Infernece:   4%|▎         | 6/169 [00:12<05:15,  1.93s/it]Infernece:   4%|▍         | 7/169 [00:14<05:09,  1.91s/it]Infernece:   5%|▍         | 8/169 [00:17<06:01,  2.24s/it]Infernece:   5%|▌         | 9/169 [00:18<05:22,  2.02s/it]Infernece:   6%|▌         | 10/169 [00:20<04:57,  1.87s/it]Infernece:   7%|▋         | 11/169 [00:22<05:11,  1.97s/it]Infernece:   7%|▋         | 12/169 [00:23<04:49,  1.85s/it]Infernece:   8%|▊         | 13/169 [00:25<04:41,  1.80s/it]Infernece:   8%|▊         | 14/169 [00:28<05:47,  2.24s/it]Infernece:   9%|▉         | 15/169 [00:31<05:47,  2.26s/it]Infernece:   9%|▉         | 16/169 [00:33<05:37,  2.21s/it]Infernece:  10%|█         | 17/169 [00:35<05:34,  2.20s/it]Infernece:  11%|█         | 18/169 [00:38<06:10,  2.46s/it]Infernece:  11%|█         | 19/169 [00:40<05:58,  2.39s/it]Infernece:  12%|█▏        | 20/169 [00:42<05:27,  2.20s/it]Infernece:  12%|█▏        | 21/169 [00:44<05:19,  2.16s/it]Infernece:  13%|█▎        | 22/169 [00:46<04:55,  2.01s/it]Infernece:  14%|█▎        | 23/169 [00:48<04:44,  1.95s/it]Infernece:  14%|█▍        | 24/169 [00:50<04:48,  1.99s/it]Infernece:  15%|█▍        | 25/169 [00:51<04:35,  1.92s/it]Infernece:  15%|█▌        | 26/169 [00:54<04:48,  2.02s/it]Infernece:  16%|█▌        | 27/169 [00:57<05:24,  2.28s/it]Infernece:  17%|█▋        | 28/169 [00:59<05:21,  2.28s/it]Infernece:  17%|█▋        | 29/169 [01:01<05:14,  2.24s/it]Infernece:  18%|█▊        | 30/169 [01:03<04:41,  2.03s/it]Infernece:  18%|█▊        | 31/169 [01:04<04:32,  1.98s/it]Infernece:  19%|█▉        | 32/169 [01:06<04:30,  1.97s/it]Infernece:  20%|█▉        | 33/169 [01:08<04:25,  1.96s/it]Infernece:  20%|██        | 34/169 [01:10<04:22,  1.95s/it]Infernece:  21%|██        | 35/169 [01:12<04:13,  1.89s/it]Infernece:  21%|██▏       | 36/169 [01:14<04:11,  1.89s/it]Infernece:  22%|██▏       | 37/169 [01:16<04:04,  1.85s/it]Infernece:  22%|██▏       | 38/169 [01:17<03:58,  1.82s/it]Infernece:  23%|██▎       | 39/169 [01:19<03:48,  1.76s/it]Infernece:  24%|██▎       | 40/169 [01:21<03:50,  1.79s/it]Infernece:  24%|██▍       | 41/169 [01:23<03:46,  1.77s/it]Infernece:  25%|██▍       | 42/169 [01:24<03:33,  1.68s/it]Infernece:  25%|██▌       | 43/169 [01:26<03:42,  1.76s/it]Infernece:  26%|██▌       | 44/169 [01:29<04:13,  2.03s/it]Infernece:  27%|██▋       | 45/169 [01:31<04:40,  2.26s/it]Infernece:  27%|██▋       | 46/169 [01:34<04:51,  2.37s/it]Infernece:  28%|██▊       | 47/169 [01:36<04:42,  2.31s/it]Infernece:  28%|██▊       | 48/169 [01:38<04:26,  2.20s/it]Infernece:  29%|██▉       | 49/169 [01:40<04:23,  2.20s/it]Infernece:  30%|██▉       | 50/169 [01:43<04:29,  2.27s/it]Infernece:  30%|███       | 51/169 [01:45<04:24,  2.24s/it]Infernece:  31%|███       | 52/169 [01:47<04:16,  2.19s/it]Infernece:  31%|███▏      | 53/169 [01:49<03:50,  1.98s/it]Infernece:  32%|███▏      | 54/169 [01:50<03:44,  1.95s/it]Infernece:  33%|███▎      | 55/169 [01:53<03:56,  2.08s/it]Infernece:  33%|███▎      | 56/169 [01:55<04:05,  2.17s/it]Infernece:  34%|███▎      | 57/169 [01:57<03:57,  2.12s/it]Infernece:  34%|███▍      | 58/169 [01:59<03:45,  2.04s/it]Infernece:  35%|███▍      | 59/169 [02:01<03:36,  1.97s/it]Infernece:  36%|███▌      | 60/169 [02:03<03:35,  1.97s/it]Infernece:  36%|███▌      | 61/169 [02:05<03:42,  2.06s/it]Infernece:  37%|███▋      | 62/169 [02:07<03:50,  2.15s/it]Infernece:  37%|███▋      | 63/169 [02:10<04:13,  2.39s/it]Infernece:  38%|███▊      | 64/169 [02:12<04:00,  2.29s/it]Infernece:  38%|███▊      | 65/169 [02:14<03:43,  2.15s/it]Infernece:  39%|███▉      | 66/169 [02:17<03:51,  2.25s/it]Infernece:  40%|███▉      | 67/169 [02:18<03:30,  2.06s/it]Infernece:  40%|████      | 68/169 [02:20<03:23,  2.02s/it]Infernece:  41%|████      | 69/169 [02:23<03:27,  2.08s/it]Infernece:  41%|████▏     | 70/169 [02:25<03:29,  2.11s/it]Infernece:  42%|████▏     | 71/169 [02:27<03:20,  2.04s/it]Infernece:  43%|████▎     | 72/169 [02:28<03:13,  1.99s/it]Infernece:  43%|████▎     | 73/169 [02:31<03:14,  2.02s/it]Infernece:  44%|████▍     | 74/169 [02:32<03:05,  1.95s/it]Infernece:  44%|████▍     | 75/169 [02:34<03:07,  2.00s/it]Infernece:  45%|████▍     | 76/169 [02:36<02:59,  1.93s/it]Infernece:  46%|████▌     | 77/169 [02:38<02:57,  1.93s/it]Infernece:  46%|████▌     | 78/169 [02:40<02:51,  1.89s/it]Infernece:  47%|████▋     | 79/169 [02:41<02:39,  1.77s/it]Infernece:  47%|████▋     | 80/169 [02:43<02:38,  1.78s/it]Infernece:  48%|████▊     | 81/169 [02:45<02:31,  1.72s/it]Infernece:  49%|████▊     | 82/169 [02:47<02:31,  1.74s/it]Infernece:  49%|████▉     | 83/169 [02:49<02:43,  1.90s/it]Infernece:  50%|████▉     | 84/169 [02:50<02:29,  1.76s/it]Infernece:  50%|█████     | 85/169 [02:52<02:27,  1.75s/it]Infernece:  51%|█████     | 86/169 [02:54<02:24,  1.74s/it]Infernece:  51%|█████▏    | 87/169 [02:55<02:22,  1.73s/it]Infernece:  52%|█████▏    | 88/169 [02:58<02:32,  1.89s/it]Infernece:  53%|█████▎    | 89/169 [03:00<02:31,  1.90s/it]Infernece:  53%|█████▎    | 90/169 [03:01<02:25,  1.84s/it]Infernece:  54%|█████▍    | 91/169 [03:04<02:34,  1.98s/it]Infernece:  54%|█████▍    | 92/169 [03:06<02:38,  2.05s/it]Infernece:  55%|█████▌    | 93/169 [03:09<03:06,  2.45s/it]Infernece:  56%|█████▌    | 94/169 [03:12<02:59,  2.39s/it]Infernece:  56%|█████▌    | 95/169 [03:14<02:49,  2.29s/it]Infernece:  57%|█████▋    | 96/169 [03:15<02:35,  2.13s/it]Infernece:  57%|█████▋    | 97/169 [03:18<02:39,  2.22s/it]Infernece:  58%|█████▊    | 98/169 [03:21<02:49,  2.39s/it]Infernece:  59%|█████▊    | 99/169 [03:23<02:46,  2.38s/it]Infernece:  59%|█████▉    | 100/169 [03:25<02:39,  2.31s/it]Infernece:  60%|█████▉    | 101/169 [03:27<02:37,  2.32s/it]Infernece:  60%|██████    | 102/169 [03:29<02:29,  2.23s/it]Infernece:  61%|██████    | 103/169 [03:31<02:18,  2.10s/it]Infernece:  62%|██████▏   | 104/169 [03:34<02:26,  2.25s/it]Infernece:  62%|██████▏   | 105/169 [03:36<02:13,  2.09s/it]Infernece:  63%|██████▎   | 106/169 [03:37<02:08,  2.04s/it]Infernece:  63%|██████▎   | 107/169 [03:39<01:58,  1.91s/it]Infernece:  64%|██████▍   | 108/169 [03:41<01:56,  1.91s/it]Infernece:  64%|██████▍   | 109/169 [03:43<01:53,  1.89s/it]Infernece:  65%|██████▌   | 110/169 [03:45<01:49,  1.85s/it]Infernece:  66%|██████▌   | 111/169 [03:47<01:57,  2.03s/it]Infernece:  66%|██████▋   | 112/169 [03:49<01:56,  2.04s/it]Infernece:  67%|██████▋   | 113/169 [03:51<01:54,  2.05s/it]Infernece:  67%|██████▋   | 114/169 [03:53<01:43,  1.87s/it]Infernece:  68%|██████▊   | 115/169 [03:54<01:41,  1.88s/it]Infernece:  69%|██████▊   | 116/169 [03:56<01:40,  1.90s/it]Infernece:  69%|██████▉   | 117/169 [03:59<01:41,  1.96s/it]Infernece:  70%|██████▉   | 118/169 [04:01<01:48,  2.12s/it]Infernece:  70%|███████   | 119/169 [04:03<01:44,  2.10s/it]Infernece:  71%|███████   | 120/169 [04:06<01:57,  2.39s/it]Infernece:  72%|███████▏  | 121/169 [04:08<01:43,  2.15s/it]Infernece:  72%|███████▏  | 122/169 [04:09<01:34,  2.02s/it]Infernece:  73%|███████▎  | 123/169 [04:13<01:48,  2.36s/it]Infernece:  73%|███████▎  | 124/169 [04:14<01:35,  2.13s/it]Infernece:  74%|███████▍  | 125/169 [04:16<01:25,  1.95s/it]Infernece:  75%|███████▍  | 126/169 [04:18<01:34,  2.19s/it]Infernece:  75%|███████▌  | 127/169 [04:20<01:24,  2.02s/it]Infernece:  76%|███████▌  | 128/169 [04:22<01:22,  2.02s/it]Infernece:  76%|███████▋  | 129/169 [04:24<01:20,  2.01s/it]Infernece:  77%|███████▋  | 130/169 [04:26<01:18,  2.02s/it]Infernece:  78%|███████▊  | 131/169 [04:29<01:22,  2.18s/it]Infernece:  78%|███████▊  | 132/169 [04:31<01:16,  2.07s/it]Infernece:  79%|███████▊  | 133/169 [04:33<01:16,  2.13s/it]Infernece:  79%|███████▉  | 134/169 [04:35<01:13,  2.11s/it]Infernece:  80%|███████▉  | 135/169 [04:37<01:12,  2.13s/it]Infernece:  80%|████████  | 136/169 [04:39<01:06,  2.00s/it]Infernece:  81%|████████  | 137/169 [04:41<01:10,  2.19s/it]Infernece:  82%|████████▏ | 138/169 [04:44<01:07,  2.19s/it]Infernece:  82%|████████▏ | 139/169 [04:45<01:00,  2.00s/it]Infernece:  83%|████████▎ | 140/169 [04:47<00:54,  1.88s/it]Infernece:  83%|████████▎ | 141/169 [04:49<00:54,  1.95s/it]Infernece:  84%|████████▍ | 142/169 [04:51<00:57,  2.14s/it]Infernece:  85%|████████▍ | 143/169 [04:55<01:04,  2.50s/it]Infernece:  85%|████████▌ | 144/169 [04:57<01:01,  2.47s/it]Infernece:  86%|████████▌ | 145/169 [05:00<00:59,  2.47s/it]Infernece:  86%|████████▋ | 146/169 [05:02<00:54,  2.35s/it]Infernece:  87%|████████▋ | 147/169 [05:05<00:55,  2.51s/it]Infernece:  88%|████████▊ | 148/169 [05:07<00:53,  2.55s/it]Infernece:  88%|████████▊ | 149/169 [05:10<00:54,  2.71s/it]Infernece:  89%|████████▉ | 150/169 [05:13<00:52,  2.76s/it]Infernece:  89%|████████▉ | 151/169 [05:15<00:45,  2.51s/it]Infernece:  90%|████████▉ | 152/169 [05:18<00:42,  2.51s/it]Infernece:  91%|█████████ | 153/169 [05:20<00:41,  2.59s/it]Infernece:  91%|█████████ | 154/169 [05:23<00:36,  2.46s/it]Infernece:  92%|█████████▏| 155/169 [05:24<00:31,  2.28s/it]Infernece:  92%|█████████▏| 156/169 [05:27<00:30,  2.34s/it]Infernece:  93%|█████████▎| 157/169 [05:29<00:27,  2.30s/it]Infernece:  93%|█████████▎| 158/169 [05:31<00:23,  2.10s/it]Infernece:  94%|█████████▍| 159/169 [05:33<00:20,  2.03s/it]Infernece:  95%|█████████▍| 160/169 [05:34<00:17,  1.93s/it]Infernece:  95%|█████████▌| 161/169 [05:36<00:14,  1.79s/it]Infernece:  96%|█████████▌| 162/169 [05:38<00:13,  1.89s/it]Infernece:  96%|█████████▋| 163/169 [05:40<00:11,  1.89s/it]Infernece:  97%|█████████▋| 164/169 [05:42<00:09,  2.00s/it]Infernece:  98%|█████████▊| 165/169 [05:44<00:08,  2.11s/it]Infernece:  98%|█████████▊| 166/169 [05:47<00:06,  2.17s/it]Infernece:  99%|█████████▉| 167/169 [05:49<00:04,  2.16s/it]Infernece:  99%|█████████▉| 168/169 [05:51<00:02,  2.20s/it]Infernece: 100%|██████████| 169/169 [05:53<00:00,  2.05s/it]Infernece: 100%|██████████| 169/169 [05:53<00:00,  2.09s/it]
10/29/2021 17:21:16 - INFO - __main__ - Starting inference ... Done
