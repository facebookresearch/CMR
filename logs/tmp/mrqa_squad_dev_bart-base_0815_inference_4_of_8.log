10/29/2021 17:12:48 - INFO - __main__ - Config args: Namespace(append_another_bos=True, checkpoint='', dataset='mrqa', debug=False, dev_file='', do_lowercase=False, do_predict=True, do_train=False, max_input_length=888, max_output_length=50, model='facebook/bart-base', num_beams=3, output_dir='out/mrqa_squad_bart-base_1029_upstream_model/', predict_batch_size=64, predict_checkpoint='out/mrqa_squad_bart-base_1029_upstream_model//best-model.pt', prefix='', quiet=False, seed=42, train_file='')
10/29/2021 17:12:49 - INFO - __main__ - dataset_size=10474, num_shards=8, local_shard_id=4
10/29/2021 17:12:49 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-vocab.json from cache at /private/home/yuchenlin/.cache/torch/transformers/1ae1f5b6e2b22b25ccc04c000bb79ca847aa226d0761536b011cf7e5868f0655.ef00af9e673c7160b4d41cfda1f48c5f4cba57d5142754525572a846a1ab1b9b
10/29/2021 17:12:49 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-merges.txt from cache at /private/home/yuchenlin/.cache/torch/transformers/f8f83199a6270d582d6245dc100e99c4155de81c9745c6248077018fe01abcfb.70bec105b4158ed9a1747fea67a43f5dee97855c64d62b6ec3742f4cfdb5feda
10/29/2021 17:12:49 - INFO - __main__ - Start tokenizing ... 1309 instances
10/29/2021 17:12:49 - INFO - __main__ - Printing 3 examples
10/29/2021 17:12:49 - INFO - __main__ - Question: Which German architect was asked to produce a design for the museum? </s> Context: The V&A has its origins in the Great Exhibition of 1851, with which Henry Cole, the museum's first director, was involved in planning; initially it was known as the Museum of Manufactures, first opening in May 1852 at Marlborough House, but by September had been transferred to Somerset House. At this stage the collections covered both applied art and science. Several of the exhibits from the Exhibition were purchased to form the nucleus of the collection. By February 1854 discussions were underway to transfer the museum to the current site and it was renamed South Kensington Museum. In 1855 the German architect Gottfried Semper, at the request of Cole, produced a design for the museum, but it was rejected by the Board of Trade as too expensive. The site was occupied by Brompton Park House; this was extended including the first refreshment rooms opened in 1857, the museum being the first in the world to provide such a facility.
10/29/2021 17:12:49 - INFO - __main__ - ['Gottfried Semper']
10/29/2021 17:12:49 - INFO - __main__ - Question: What festival takes place in April in Newcastle? </s> Context: The Newcastle Beer Festival, organized by CAMRA, takes place in April. In May, Newcastle and Gateshead host the Evolution Festival, a music festival held on the Newcastle and Gateshead Quaysides over the Spring bank holiday, with performances by acts from the world of Rock, Indie and Dance music. The biennial AV Festival of international electronic art, featuring exhibitions, concerts, conferences and film screenings, is held in March. The North East Art Expo, a festival of art and design from the regions professional artists, is held in late May. EAT! NewcastleGateshead, a festival of food and drink, runs for 2 weeks each year in mid June.
10/29/2021 17:12:49 - INFO - __main__ - ['The Newcastle Beer Festival']
10/29/2021 17:12:49 - INFO - __main__ - Question: When is the Evolution Festival hosted? </s> Context: The Newcastle Beer Festival, organized by CAMRA, takes place in April. In May, Newcastle and Gateshead host the Evolution Festival, a music festival held on the Newcastle and Gateshead Quaysides over the Spring bank holiday, with performances by acts from the world of Rock, Indie and Dance music. The biennial AV Festival of international electronic art, featuring exhibitions, concerts, conferences and film screenings, is held in March. The North East Art Expo, a festival of art and design from the regions professional artists, is held in late May. EAT! NewcastleGateshead, a festival of food and drink, runs for 2 weeks each year in mid June.
10/29/2021 17:12:49 - INFO - __main__ - ['Newcastle and Gateshead', 'May', 'over the Spring bank holiday']
10/29/2021 17:12:49 - INFO - __main__ - Tokenizing Input ...
10/29/2021 17:12:51 - INFO - __main__ - Tokenizing Input ... Done!
10/29/2021 17:12:51 - INFO - __main__ - Tokenizing Output ...
10/29/2021 17:12:51 - INFO - __main__ - Tokenizing Output ... Done!
10/29/2021 17:12:51 - INFO - __main__ - Loaded 1309 examples from dev data
10/29/2021 17:12:51 - INFO - __main__ - Loading checkpoint from out/mrqa_squad_bart-base_1029_upstream_model//best-model.pt ....
10/29/2021 17:12:52 - INFO - transformers.configuration_utils - loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/facebook/bart-base/config.json from cache at /private/home/yuchenlin/.cache/torch/transformers/09f4fcaeaf785dd3b97b085d6e3510c7081f586ec8e75981683c6299c0f81d9d.e8d516ad807436d395effad8c2326786872659b7dd1210827ac67c761198a0eb
10/29/2021 17:12:52 - INFO - transformers.configuration_utils - Model config BartConfig {
  "activation_dropout": 0.1,
  "activation_function": "gelu",
  "add_bias_logits": false,
  "add_final_layer_norm": false,
  "architectures": [
    "BartModel",
    "BartForConditionalGeneration",
    "BartForSequenceClassification"
  ],
  "attention_dropout": 0.1,
  "bos_token_id": 0,
  "classif_dropout": 0.0,
  "d_model": 768,
  "decoder_attention_heads": 12,
  "decoder_ffn_dim": 3072,
  "decoder_layerdrop": 0.0,
  "decoder_layers": 6,
  "decoder_start_token_id": 2,
  "dropout": 0.1,
  "early_stopping": true,
  "encoder_attention_heads": 12,
  "encoder_ffn_dim": 3072,
  "encoder_layerdrop": 0.0,
  "encoder_layers": 6,
  "eos_token_id": 2,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1",
    "2": "LABEL_2"
  },
  "init_std": 0.02,
  "is_encoder_decoder": true,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1,
    "LABEL_2": 2
  },
  "max_position_embeddings": 1024,
  "model_type": "bart",
  "no_repeat_ngram_size": 3,
  "normalize_before": false,
  "normalize_embedding": true,
  "num_beams": 4,
  "num_hidden_layers": 6,
  "pad_token_id": 1,
  "scale_embedding": false,
  "static_position_embeddings": false,
  "task_specific_params": {
    "summarization": {
      "length_penalty": 1.0,
      "max_length": 128,
      "min_length": 12,
      "num_beams": 4
    },
    "summarization_cnn": {
      "length_penalty": 2.0,
      "max_length": 142,
      "min_length": 56,
      "num_beams": 4
    },
    "summarization_xsum": {
      "length_penalty": 1.0,
      "max_length": 62,
      "min_length": 11,
      "num_beams": 6
    }
  },
  "vocab_size": 50265
}

10/29/2021 17:12:52 - INFO - transformers.modeling_utils - loading weights file https://cdn.huggingface.co/facebook/bart-base/pytorch_model.bin from cache at /private/home/yuchenlin/.cache/torch/transformers/566c05fb6983817e8ad7a4fa51e3099fe9caa3b31730f964bc5198d71c677523.0a3d95c18c1e434448941bc25accea7b122882be6526fb67c8e8fb6d5ebc711c
10/29/2021 17:12:56 - INFO - __main__ - Loading checkpoint from out/mrqa_squad_bart-base_1029_upstream_model//best-model.pt .... Done!
10/29/2021 17:13:00 - INFO - __main__ - Starting inference ...
Infernece:   0%|          | 0/21 [00:00<?, ?it/s]Infernece:   5%|▍         | 1/21 [00:02<00:58,  2.90s/it]Infernece:  10%|▉         | 2/21 [00:04<00:48,  2.57s/it]Infernece:  14%|█▍        | 3/21 [00:06<00:42,  2.35s/it]Infernece:  19%|█▉        | 4/21 [00:08<00:39,  2.34s/it]Infernece:  24%|██▍       | 5/21 [00:12<00:44,  2.76s/it]Infernece:  29%|██▊       | 6/21 [00:14<00:38,  2.60s/it]Infernece:  33%|███▎      | 7/21 [00:16<00:34,  2.45s/it]Infernece:  38%|███▊      | 8/21 [00:20<00:34,  2.66s/it]Infernece:  43%|████▎     | 9/21 [00:22<00:31,  2.63s/it]Infernece:  48%|████▊     | 10/21 [00:24<00:27,  2.46s/it]Infernece:  52%|█████▏    | 11/21 [00:27<00:24,  2.48s/it]Infernece:  57%|█████▋    | 12/21 [00:29<00:21,  2.37s/it]Infernece:  62%|██████▏   | 13/21 [00:31<00:18,  2.31s/it]Infernece:  67%|██████▋   | 14/21 [00:33<00:15,  2.18s/it]Infernece:  71%|███████▏  | 15/21 [00:35<00:13,  2.24s/it]Infernece:  76%|███████▌  | 16/21 [00:37<00:11,  2.22s/it]Infernece:  81%|████████  | 17/21 [00:40<00:09,  2.47s/it]Infernece:  86%|████████▌ | 18/21 [00:43<00:07,  2.43s/it]Infernece:  90%|█████████ | 19/21 [00:46<00:05,  2.61s/it]Infernece:  95%|█████████▌| 20/21 [00:48<00:02,  2.49s/it]Infernece: 100%|██████████| 21/21 [00:49<00:00,  2.05s/it]Infernece: 100%|██████████| 21/21 [00:49<00:00,  2.36s/it]
10/29/2021 17:13:49 - INFO - __main__ - Starting inference ... Done
